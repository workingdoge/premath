{
  "schema": 1,
  "policyKind": "ci.harness.retry.policy.v1",
  "policyId": "policy.harness.retry.v1",
  "defaultRule": {
    "maxAttempts": 1,
    "backoffClass": "none",
    "escalationAction": "stop"
  },
  "rules": [
    {
      "ruleId": "transient_retry",
      "failureClasses": [
        "executor_unavailable",
        "flaky_execution",
        "flaky_io",
        "gate_timeout",
        "network_timeout",
        "pipeline_witness_io_error"
      ],
      "maxAttempts": 3,
      "backoffClass": "exponential_short",
      "escalationAction": "issue_discover"
    },
    {
      "ruleId": "operational_retry",
      "failureClasses": [
        "instruction_runtime_invalid",
        "pipeline_missing_failure_class",
        "pipeline_invalid_witness_json",
        "pipeline_invalid_witness_shape",
        "pipeline_missing_witness",
        "required_decision_verify_invalid",
        "required_gate_ref_invalid",
        "required_witness_decide_invalid",
        "required_witness_runtime_invalid"
      ],
      "maxAttempts": 2,
      "backoffClass": "fixed_short",
      "escalationAction": "issue_discover"
    },
    {
      "ruleId": "governance_no_retry",
      "failureClasses": [
        "governance.policy_package_unpinned",
        "governance.policy_package_mismatch",
        "governance.guardrail_stage_missing",
        "governance.guardrail_stage_order_invalid",
        "governance.eval_gate_unmet",
        "governance.eval_lineage_missing",
        "governance.self_evolution_retry_missing",
        "governance.self_evolution_escalation_missing",
        "governance.self_evolution_rollback_missing",
        "governance.trace_mode_violation",
        "governance.risk_tier_profile_missing"
      ],
      "maxAttempts": 1,
      "backoffClass": "none",
      "escalationAction": "mark_blocked"
    },
    {
      "ruleId": "kcir_mapping_no_retry",
      "failureClasses": [
        "kcir_mapping_legacy_encoding_authority_violation"
      ],
      "maxAttempts": 1,
      "backoffClass": "none",
      "escalationAction": "mark_blocked"
    },
    {
      "ruleId": "semantic_no_retry",
      "failureClasses": [
        "check_failed",
        "instruction_check_not_allowed",
        "instruction_envelope_invalid",
        "instruction_envelope_invalid_json",
        "instruction_envelope_invalid_shape",
        "instruction_invalid_normalizer",
        "instruction_unknown_unroutable",
        "proposal_binding_mismatch",
        "proposal_discharge_failed",
        "proposal_invalid_shape",
        "proposal_invalid_step",
        "proposal_kcir_ref_mismatch",
        "proposal_nondeterministic",
        "proposal_unbound_policy"
      ],
      "maxAttempts": 1,
      "backoffClass": "none",
      "escalationAction": "mark_blocked"
    }
  ],
  "policyDigest": "pol1_85f35a1dd21bbfd1bd8c0b1e999303dba5f905e75ffe7eb8be25d581296ec0c7"
}
