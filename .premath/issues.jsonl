{"id":"bd-1","title":"Conformance: Spec Traceability Matrix for Promoted Draft Specs","description":"Build and maintain a spec-to-vector traceability matrix mapping promoted draft specs under specs/premath/draft/ to executable conformance vectors and checks. Identify unmapped specs and add required coverage targets.","notes":"Completed spec traceability pass: added draft/SPEC-TRACEABILITY matrix, linked from draft README/SPEC-INDEX/CONFORMANCE, and opened discovered coverage targets bd-13..bd-18 (T-IC-01, T-GATE-01, T-WID-01, T-INDEX-01, T-DINF-01, T-KERNEL-01).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-21T21:41:39.724462Z","updated_at":"2026-02-22T00:22:51.923596Z","closed_at":"2026-02-22T00:22:51.923598Z","ephemeral":false,"dependencies":[{"issue_id":"bd-1","depends_on_id":"bd-5","type":"blocks"}]}
{"id":"bd-10","title":"[Coherence v1] Observation Coherence Dashboard + Attention Projections","description":"Add explicit observation projections for policy drift, unknown classification rate, proposal reject classes, blocked-vs-ready partition integrity, and stale claims; expose through observe_* and docs dashboard.","notes":"Implemented observation coherence projections end-to-end. Observation Surface now computes summary.coherence with policy drift, instruction unknown-rate, proposal reject class aggregation, ready-vs-blocked partition integrity, and stale/contended lease health from .premath/issues.jsonl. Exposed through observe_latest/needs_attention (Rust UX + CLI), updated docs dashboard panels/metrics, and added reducer + semantics tests. Verified with `python3 tools/ci/test_observation_surface.py`, `cargo test -p premath-surreal`, `cargo test -p premath-ux`, `cargo test -p premath-cli`, `mise run ci-observation-check`.","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2026-02-21T23:07:04.277911Z","updated_at":"2026-02-22T01:24:24.930622Z","closed_at":"2026-02-22T01:24:24.930624Z","ephemeral":false,"dependencies":[{"issue_id":"bd-10","depends_on_id":"bd-7","type":"blocks"},{"issue_id":"bd-10","depends_on_id":"bd-9","type":"blocks"},{"issue_id":"bd-10","depends_on_id":"bd-12","type":"blocks"},{"issue_id":"bd-10","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-11","title":"[Coherence v1] Add Profile Overlay Claim Plumbing (specs/premath/profile)","description":"Introduce profile-overlay claim wiring in this repo (directory, claim declaration surface, doctrine-site/spec-index integration) so optional overlays are explicit and additive to base claims.","notes":"Completed profile overlay plumbing: added specs/premath/profile/ADJOINTS-AND-SITES.md and profile/README.md; updated draft/SPEC-INDEX with overlay claim scope + reading order; updated draft/README related links; added Decision 0010 in specs/process/decision-log.md.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-21T23:07:45.864868Z","updated_at":"2026-02-21T23:13:54.898148Z","closed_at":"2026-02-21T23:13:54.898152Z","ephemeral":false}
{"id":"bd-12","title":"[Coherence v1] Capability Vectors for Adjoints/Sites Obligations","description":"Add executable vectors and witness mappings for adjoint_triangle, beck_chevalley_sigma/pi, and refinement invariance under profile-scoped admissible maps, bound to (normalizerId, policyDigest).","notes":"Added executable capability claim capabilities.adjoints_sites with golden/adversarial/invariance vectors for adjoint_triangle, beck_chevalley_sigma, beck_chevalley_pi, and refinement_invariance obligations bound to (normalizerId, policyDigest). Extended instruction proposal obligation/discharge mapping to include these profile obligations and deterministic hint-based failure classes. Updated capability/conformance/spec-index docs and decision log.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-21T23:07:49.362129Z","updated_at":"2026-02-21T23:46:09.298712Z","closed_at":"2026-02-21T23:46:09.298715Z","ephemeral":false,"dependencies":[{"issue_id":"bd-12","depends_on_id":"bd-6","type":"blocks"},{"issue_id":"bd-12","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-13","title":"[Traceability] T-IC-01 Interop Core executable vectors","description":"Implement executable interop-core vectors and runner integration covering KCIR-CORE, REF-BINDING, NF parser/constructor contracts, WIRE-FORMATS, and ERROR-CODES.","notes":"Completed T-IC-01: added executable interop-core vectors and deterministic runner (tools/conformance/run_interop_core_vectors.py), integrated into mise conformance-run, updated traceability matrix statuses for KCIR-CORE/REF-BINDING/NF/WIRE-FORMATS/ERROR-CODES to covered, and passed full baseline.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:24.866012Z","updated_at":"2026-02-22T00:31:56.838751Z","closed_at":"2026-02-22T00:31:56.838759Z","ephemeral":false,"dependencies":[{"issue_id":"bd-13","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-14","title":"[Traceability] T-GATE-01 Canonical Gate vectors","description":"Promote tests/conformance/fixtures/gate from placeholder to executable deterministic golden/adversarial Gate vectors and wire into merge-gated conformance command surface.","notes":"Completed T-GATE-01: added canonical gate fixture suite under tests/conformance/fixtures/gate with deterministic runner tools/conformance/run_gate_vectors.py, integrated gate vectors into mise conformance-run, updated traceability matrix to mark GATE covered, and passed full baseline.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:29.628179Z","updated_at":"2026-02-22T00:36:32.943940Z","closed_at":"2026-02-22T00:36:32.943941Z","ephemeral":false,"dependencies":[{"issue_id":"bd-14","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-15","title":"[Traceability] T-WID-01 Witness-ID conformance vectors","description":"Add fixture-level witness-id determinism/sensitivity conformance vectors and executable validation path in merge-gated conformance checks.","notes":"Implemented executable witness-id conformance vectors and merge-gated runner path. Added tests/conformance/fixtures/witness-id suite (stability under excluded fields + sensitivity to class/lawRef/tokenPath/context), added tools/conformance/run_witness_id_vectors.py, wired suite into tools/conformance/run_fixture_suites.py (conformance-run), and updated conformance/docs traceability surfaces. SPEC-TRACEABILITY now marks WITNESS-ID.md covered; decision log entry added for T-WID-01 execution.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:35.137565Z","updated_at":"2026-02-22T00:59:31.869071Z","closed_at":"2026-02-22T00:59:31.869074Z","ephemeral":false,"dependencies":[{"issue_id":"bd-15","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-16","title":"[Traceability] T-INDEX-01 Matrix integrity check","description":"Add deterministic checker enforcing that every promoted draft spec appears exactly once in SPEC-TRACEABILITY with status classification and target IDs for gaps.","notes":"Implemented deterministic traceability matrix integrity checker and wired it into baseline. Added tools/conformance/check_spec_traceability.py enforcing: every promoted draft spec appears exactly once in SPEC-TRACEABILITY, status in {covered,instrumented,gap}, gap rows require T-*-* target IDs, and no unknown matrix rows. Added mise task traceability-check and included it in baseline. Updated SPEC-TRACEABILITY to mark SPEC-INDEX and SPEC-TRACEABILITY covered and removed T-INDEX-01 open target section. Updated CI/conformance docs and decision log (Decision 0024).","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:39.021956Z","updated_at":"2026-02-22T01:02:05.256857Z","closed_at":"2026-02-22T01:02:05.256859Z","ephemeral":false,"dependencies":[{"issue_id":"bd-16","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-17","title":"[Traceability] T-DINF-01 Doctrine-Inf semantic coverage upgrade","description":"Extend doctrine validation beyond declaration/graph coherence into executable law-level checks for declared preserved/not-preserved morphism boundaries.","notes":"Implemented T-DINF-01 doctrine semantic boundary coverage: added doctrine-inf executable vectors + fixtures, wired doctrine-check to run both site and semantic checks, updated AGENTS/docs/traceability/raw CI-TOPOS, and logged Decision 0025. Verified with `mise run doctrine-check` and `mise run traceability-check`.","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:43.700207Z","updated_at":"2026-02-22T01:06:33.828660Z","closed_at":"2026-02-22T01:06:33.828662Z","ephemeral":false,"dependencies":[{"issue_id":"bd-17","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-18","title":"[Traceability] T-KERNEL-01 Cross-model kernel vector profile","description":"Define canonical cross-model kernel conformance vector profile for reproducible comparisons in addition to host-specific proof/test surfaces.","notes":"Executed T-KERNEL-01 with canonical cross-model kernel profile vectors. Added tools/conformance/run_kernel_profile_vectors.py + tests/conformance/fixtures/kernel-profile, wired kernel-profile into cached run_fixture_suites/conformance-run, updated traceability/docs/spec references, and recorded Decision 0026. Verified with run_kernel_profile_vectors, run_fixture_suites --suite kernel-profile (RUN/HIT), mise run conformance-run, and mise run traceability-check.","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:22:46.892859Z","updated_at":"2026-02-22T01:12:46.184772Z","closed_at":"2026-02-22T01:12:46.184776Z","ephemeral":false,"dependencies":[{"issue_id":"bd-18","depends_on_id":"bd-1","type":"discovered-from"}]}
{"id":"bd-19","title":"[Conformance] Ensure all fixture suites are hook-gated with caching","description":"Ensure interop-core, gate, and capability fixture suites are all covered in pre-commit/pre-push gate paths with deterministic caching to avoid redundant reruns while preserving correctness.","notes":"Implemented deterministic KCIR-style fixture-suite caching and hook-gated executable conformance projection. Added tools/conformance/run_fixture_suites.py (kcir.cache.fixture-suite.v1 bindings, kcir1 refs, .premath/cache storage, PREMATH_CONFORMANCE_CACHE toggle), switched mise conformance-run to use suite runner, updated change projection to require conformance-run on conformance-surface deltas, updated capability vector fixture expectations, and updated conformance/CI docs to match command surface.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:37:55.046735Z","updated_at":"2026-02-22T00:46:19.172289Z","closed_at":"2026-02-22T00:46:19.172292Z","ephemeral":false,"dependencies":[{"issue_id":"bd-19","depends_on_id":"bd-2","type":"discovered-from"}]}
{"id":"bd-2","title":"Conformance: Capability Vector Gap Audit and Fixture Backfill","description":"Audit current capability vectors and fixture inventories for missing or weak coverage (including stub/invariance pairs). Propose and add concrete vectors/fixtures to close identified gaps.","notes":"Backfilled capability gap for change_morphisms lease lifecycle. Added conformance vectors for issue_lease_renew and issue_lease_release (golden + adversarial), added evaluator routes/failure classes in tools/conformance/run_capability_vectors.py, updated capability docs/decision log language, and validated via check_stub_invariance + run_capability_vectors + mise run conformance-run (cache hits observed).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-21T21:41:39.730935Z","updated_at":"2026-02-22T01:30:03.491377Z","closed_at":"2026-02-22T01:30:03.491378Z","ephemeral":false,"dependencies":[{"issue_id":"bd-2","depends_on_id":"bd-1","type":"blocks"}]}
{"id":"bd-20","title":"[Hygiene] Add deterministic no-leak guard for private/local artifacts","description":"Add a repository hygiene check to fail when tracked/staged changes include private/local surfaces (e.g. .serena/, .claude/, .premath/cache/, ad-hoc temp artifacts) outside explicit allowlists, and wire into baseline/hook gate path.","notes":"Implemented deterministic repo hygiene guardrails and fail-closed projection hardening. Added tools/ci/check_repo_hygiene.py with forbidden private/local surfaces and required .gitignore entry checks; added unit tests (tools/ci/test_repo_hygiene.py); wired ci-hygiene-check into mise baseline and hk pre-commit fast steps; extended ci-pipeline-test to include hygiene tests. Hardened change projection so mixed known+unknown non-doc deltas fail closed to baseline, and added executable change_morphisms vector golden/mixed_known_unknown_surface_runs_baseline plus manifest/runner updates. Updated CI/conformance docs and AGENTS command surface references.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T00:46:25.846947Z","updated_at":"2026-02-22T00:54:17.788796Z","closed_at":"2026-02-22T00:54:17.788800Z","ephemeral":false,"dependencies":[{"issue_id":"bd-20","depends_on_id":"bd-19","type":"discovered-from"}]}
{"id":"bd-21","title":"[Conformance] Add lease_id_mismatch adversarial vector for change_morphisms","description":"Backfill executable adversarial coverage for lease release id mismatch in capabilities.change_morphisms so CAPABILITY-VECTORS spec claims match conformance evidence. Add fixture(s), evaluator routing (if needed), and run conformance gates.","notes":"Added missing adversarial executable coverage for lease_id_mismatch under capabilities.change_morphisms. Added vector manifest entry and fixture pair (issue_lease_release_id_mismatch_reject), routed vector in run_capability_vectors dispatcher, and validated with check_stub_invariance + run_capability_vectors + mise run conformance-run (capabilities=8, vectors=92).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T01:39:44.004450Z","updated_at":"2026-02-22T01:40:56.103671Z","closed_at":"2026-02-22T01:40:56.103673Z","ephemeral":false}
{"id":"bd-22","title":"[Docs Coherence] Resolve SPEC-INDEX normative vs informative scope contradiction","description":"Fix contradictory classification in specs/premath/draft/SPEC-INDEX.md where LLM/CI/SQUEAK capability docs are listed as normative when claimed and also listed as informative. Establish one authoritative rule: capability/profile docs are normative only when claimed; otherwise informative context. Update wording in sections 5.4/5.5 and confirm against CONFORMANCE/CAPABILITY-VECTORS.","notes":"Resolved normative-vs-informative contradiction in SPEC-INDEX by making conditional normativity explicit in §5.5 for LLM-INSTRUCTION-DOCTRINE, LLM-PROPOSAL-CHECKING, raw/SQUEAK-SITE, and raw/PREMATH-CI; clarified informative/default status unless claimed under §5.4/§5.6. Verified with check_spec_traceability and doctrine-check.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T01:45:43.967466Z","updated_at":"2026-02-22T01:56:07.981597Z","closed_at":"2026-02-22T01:56:07.981600Z","ephemeral":false}
{"id":"bd-23","title":"[Docs Coherence] Refresh CI closure architecture docs to match executable baseline","description":"Update docs/design/CI-CLOSURE.md and docs/design/ARCHITECTURE-MAP.md to reflect current baseline/CI chain in .mise.toml and tools/ci (traceability-check, doctrine-check + doctrine-inf vectors, pipeline/observation/instruction checks, fixture-suite conformance runner). Ensure docs explicitly treat .mise.toml + pipeline scripts as operational source of truth.","notes":"Updated docs/design/CI-CLOSURE.md and docs/design/ARCHITECTURE-MAP.md to match current executable baseline and CI entrypoints. Added explicit operational source-of-truth references (.mise.toml tasks + pipeline scripts), refreshed baseline closure description (traceability/doctrine/conformance-run + CI/control-plane checks), and included LLM-PROPOSAL-CHECKING in doctrine layer/path.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T01:45:48.825612Z","updated_at":"2026-02-22T01:57:10.718585Z","closed_at":"2026-02-22T01:57:10.718588Z","ephemeral":false}
{"id":"bd-24","title":"[Docs Coherence] Align README capability closure list with conformance set","description":"README baseline/conformance summary omits capabilities.adjoints_sites while run_capability_vectors and conformance docs include it. Update README capability closure list so documented gate scope matches executable conformance scope.","notes":"Aligned README baseline capability closure list with executable conformance capability set by adding capabilities.adjoints_sites. Verified parity against tools/conformance/README.md and run_capability_vectors capability registry.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T01:45:51.871031Z","updated_at":"2026-02-22T01:57:10.741864Z","closed_at":"2026-02-22T01:57:10.741867Z","ephemeral":false}
{"id":"bd-25","title":"[Docs Tooling] Add deterministic docs-coherence check for architecture surfaces","description":"Add a lightweight check that prevents drift between executable operational surfaces (.mise.toml, tools/ci/*, tools/conformance/*) and key docs (README, docs/design/CI-CLOSURE.md, docs/design/ARCHITECTURE-MAP.md, SPEC-INDEX normative scope statements). Start with critical invariants: capability list parity, baseline gate parity, and normative-vs-informative consistency for capability-scoped docs.","notes":"Implemented deterministic docs-coherence checker at tools/conformance/check_docs_coherence.py and wired mise task docs-coherence-check into baseline. Check enforces: executable capability parity (run_capability_vectors DEFAULT set vs README/tools-conformance/SPEC-INDEX §5.4 + fixture manifests), baseline task parity (.mise [tasks.baseline] vs docs/design/CI-CLOSURE baseline list), projected check parity (tools/ci/change_projection CHECK_ORDER vs CI-CLOSURE projected list), and SPEC-INDEX §5.4/§5.5 conditional normativity clauses for capability-scoped docs. Added parser unit tests tools/conformance/test_docs_coherence.py and included in ci-pipeline-test. Updated docs surfaces (README, CI-CLOSURE, ARCHITECTURE-MAP, tools/conformance/README, AGENTS). Verified with python3 tools/conformance/test_docs_coherence.py, python3 tools/conformance/check_docs_coherence.py, mise run docs-coherence-check, mise run traceability-check, mise run doctrine-check, mise run ci-pipeline-test, and full mise run baseline.","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T01:45:56.590860Z","updated_at":"2026-02-22T02:10:37.189710Z","closed_at":"2026-02-22T02:10:37.189714Z","ephemeral":false,"dependencies":[{"issue_id":"bd-25","depends_on_id":"bd-22","type":"blocks"},{"issue_id":"bd-25","depends_on_id":"bd-23","type":"blocks"},{"issue_id":"bd-25","depends_on_id":"bd-24","type":"blocks"}]}
{"id":"bd-26","title":"[EPIC] premath-coherence: typed coherence contract + kernel-backed checker","description":"Define a first-class Premath coherence contract artifact and executable checker surface. Scope: (1) new spec draft/PREMATH-COHERENCE and machine artifact draft/COHERENCE-CONTRACT.json, (2) obligation compilation for scope_noncontradiction/capability_parity/gate_chain_parity/operation_reachability/overlay_traceability, (3) deterministic failure classes + witness schema, (4) implementation as kernel-backed checking adapter (new premath-coherence surface) without changing premath-kernel authority, (5) baseline integration and traceability row updates.","notes":"Implemented premath-coherence crate + coherence-check CLI, added coherence contract/spec/docs traceability, added baseline coherence gate, aligned conformance proposal canonicalization with instruction_proposal checker, tightened instruction envelope binding whitespace validation, added reject witness test coverage, and verified full baseline pass.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T01:53:16.361383Z","updated_at":"2026-02-22T02:30:08.190370Z","closed_at":"2026-02-22T02:30:08.190373Z","ephemeral":false,"dependencies":[{"issue_id":"bd-26","depends_on_id":"bd-22","type":"blocks"},{"issue_id":"bd-26","depends_on_id":"bd-23","type":"blocks"},{"issue_id":"bd-26","depends_on_id":"bd-24","type":"blocks"}]}
{"id":"bd-27","title":"[Migration Plan] Python gate/check stack -> premath-coherence core (phased parity plan)","description":"Planning/phase-order issue for migration from Python check/gate semantics to premath-coherence core.\nScope:\n- define phased boundary and parity criteria,\n- define witness/projection equivalence contract,\n- define cutover strategy and rollback safety.\nExecution changes land in downstream implementation issues (e.g., bd-34).","notes":"Defined and landed the phased migration contract in `draft/PREMATH-COHERENCE` §10 covering: (1) authority boundary (Python as adapter only; semantics in `premath-coherence` core), (2) parity contract keys (`result`, `failureClasses`, bindings, check/projection digests, proposal identity refs), (3) phased cutover (`phase_0_inventory` -> `phase_4_deprecate_legacy`), and (4) rollback safety constraints (witness-first fail-closed path switching). Recorded Decision 0039. Verified with full `mise run baseline`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T01:53:21.042584Z","updated_at":"2026-02-22T03:47:34.881195Z","closed_at":"2026-02-22T03:47:34.881199Z","ephemeral":false,"dependencies":[{"issue_id":"bd-27","depends_on_id":"bd-26","type":"blocks"},{"issue_id":"bd-27","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-28","title":"[EPIC] Unification + Reduction: universal KCIR, coherent typing, and event-memory architecture","description":"North-star unification program:\n- one canonical semantic pipeline: instruction/proposal -> typing/checking -> obligations -> discharge -> witness\n- one canonical substrate for long-lived memory and projections\n- one canonical intermediate representation boundary (KCIR) to reduce duplicate encodings\nAcceptance:\n1) coherent architecture doc and issue graph exists,\n2) core subtasks implemented with deterministic witnesses/vectors,\n3) command surface remains doctrine-gated and fail-closed.","notes":"Progress update: migration thread advanced with core-backed `premath proposal-check` command and instruction pipeline cutover (proposal ingest/discharge now delegated from Python wrapper to premath-coherence via CLI). Added follow-up bd-46 to complete remaining conformance proposal-evaluator migration to the same core path.\n\nStatic checkpoint pinned before larger queued transformations:\n- commit: `faaee60`\n- tag: `static/2026-02-22-pre-transform`\n- attested required projection digest: `proj1_ace4d9d49dbfaf18361f3b20bb37333e253039251f14d1872b1ccfb3c27cee8d`.\n\nRecent bd-28 reduction slices completed:\n- `bd-84`: semantic polarity coverage for coherence-site obligations.\n- `bd-85`: invariance pair contract enforcement for coherence-site fixtures.\n- `bd-86`: harmonized invariance pair contract across site + transport fixtures.\n- `bd-87`: transport polarity parity (golden/adversarial + accepted/rejected).\n- `bd-88`: factored shared polarity accounting helper in premath-coherence.\n- `bd-89`: added `premath issue backend-status` (jsonl authority + surreal projection + JJ state).\n- `bd-90`: exposed `issue_backend_status` MCP read tool.\n- `bd-91`: unified backend-status state collection across CLI + MCP.\n- `bd-92`: unified backend-status payload rendering across CLI + MCP.","status":"open","priority":1,"issue_type":"task","created_at":"2026-02-22T02:46:27.162673Z","updated_at":"2026-02-22T11:07:55.672942Z","ephemeral":false}
{"id":"bd-29","title":"[Memory] Canonical append-only event substrate + deterministic projections","description":"Introduce canonical .premath/memory/events.jsonl as authoritative append-only substrate. Derive issues/observation/ci views through deterministic reducers.\nAcceptance:\n- event schema v1 documented,\n- projection reducers implemented and replay-stable,\n- .premath/issues.jsonl treated as projection or explicitly synchronized view.","notes":"Completed canonical event-memory projection loop at CLI surface: added deterministic replay path `premath issue replay-events` (issue.event.v1 -> issues snapshot), with equivalence reporting to existing snapshots. Combined with prior `issue migrate-events`, issue memory now has deterministic snapshot<->event projection commands and smoke coverage for idempotent replay.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:46:34.700689Z","updated_at":"2026-02-22T03:19:14.153179Z","closed_at":"2026-02-22T03:19:14.153181Z","ephemeral":false,"dependencies":[{"issue_id":"bd-29","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-29","depends_on_id":"bd-40","type":"discovered-from"}]}
{"id":"bd-3","title":"Conformance: Doctrine-Site Coverage and Reachability Verification","description":"Review doctrine declarations and operation-site reachability checks to ensure doctrine-site coverage is complete and enforceable. Add missing declarations/tests where gaps are found.","notes":"Completed doctrine-site coverage/reachability verification. Audited doctrine-check pipeline and identified missing operation-site coverage for tools/conformance/run_doctrine_inf_vectors.py. Added op/conformance.doctrine_inf node + cover.ci membership + e.ci.op.doctrine_inf edge in DOCTRINE-SITE.json, updated DOCTRINE-SITE.md repository note, and added Decision 0028. Validated with mise run doctrine-check (nodes=20, edges=25, operations=8).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-21T21:41:39.749635Z","updated_at":"2026-02-22T01:36:07.733676Z","closed_at":"2026-02-22T01:36:07.733677Z","ephemeral":false,"dependencies":[{"issue_id":"bd-3","depends_on_id":"bd-2","type":"blocks"}]}
{"id":"bd-30","title":"[Memory] Replay invariance + cache for event reducers and fixture pipelines","description":"Add replay invariance checks and content-addressed caching for memory/coherence reducers and fixture execution.\nAcceptance:\n- same input event stream yields identical projections,\n- cache keys bound to deterministic digests,\n- conformance vectors include reducer invariance adversarial/golden cases.","notes":"Implemented deterministic replay-cache binding for issue.event.v1 projections. Added event/snapshot refs (ev1_/iss1_), replay cache metadata and cache-hit short-circuit in the issue replay-events command, replay smoke coverage for cache-hit behavior, and executable change_morphisms vectors (golden/adversarial/invariance) for replay-cache determinism and ref-mismatch rejection. Baseline gate passes.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T02:46:34.724826Z","updated_at":"2026-02-22T03:29:42.324363Z","closed_at":"2026-02-22T03:29:37.156036Z","ephemeral":false,"dependencies":[{"issue_id":"bd-30","depends_on_id":"bd-29","type":"blocks"},{"issue_id":"bd-30","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-30","depends_on_id":"bd-40","type":"discovered-from"}]}
{"id":"bd-31","title":"[KCIR] Universalize KCIR as semantic IR for instruction/proposal/coherence boundaries","description":"Define and implement KCIR boundary so instruction proposals, checker obligations, and coherence evidence share one IR contract.\nAcceptance:\n- IR mapping spec for instruction/proposal -> KCIR forms,\n- deterministic witness lineage through KCIR refs,\n- removal/deprecation plan for duplicate non-KCIR semantic encodings.","notes":"Closed via shared KCIR-bound proposal identity authority path: added `validate_proposal_payload(...)` in `tools/ci/instruction_proposal.py` and routed capability instruction/adjoints proposal checks through it (removed duplicate declared digest/KCIR ref validation logic). Added `tools/ci/test_instruction_proposal.py` and wired it into `mise run ci-pipeline-test`. Added explicit KCIR proposal projection/deprecation contract in `draft/UNIFICATION-DOCTRINE` (§8) and `draft/LLM-PROPOSAL-CHECKING` (§5.1/§5.2), recorded in Decision 0042. Baseline + conformance-run pass.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:46:34.802536Z","updated_at":"2026-02-22T04:04:45.092626Z","closed_at":"2026-02-22T04:04:45.092628Z","ephemeral":false,"dependencies":[{"issue_id":"bd-31","depends_on_id":"bd-29","type":"blocks"},{"issue_id":"bd-31","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-32","title":"[Typechecker] Compile typing judgments into coherence obligations/discharge","description":"Deeply integrate typechecker with coherence by compiling typing judgments into obligation sets and deterministic discharge witnesses, rather than parallel verdict paths.\nAcceptance:\n- explicit typed judgment -> obligation compilation contract,\n- shared failure class map with bidir/Gate,\n- checker outputs authoritative typed witness artifacts.","notes":"Closed: typed proposal judgments now compile to deterministic obligation/discharge artifacts on the authoritative checker path and are emitted in instruction witnesses (`proposalIngest.obligations` + `proposalIngest.discharge`). Shared failure-class mapping remains centralized in `tools/ci/instruction_proposal.py` (`OBLIGATION_TO_GATE_FAILURE`, `GATE_FAILURE_TO_LAW_REF`), and this pass removed duplicate proposal identity validation by routing conformance instruction/adjoints proposal checks through `validate_proposal_payload(...)`. Added dedicated validator tests (`tools/ci/test_instruction_proposal.py`) and baseline-gated execution via `ci-pipeline-test`; docs tightened in `draft/LLM-PROPOSAL-CHECKING` and `draft/UNIFICATION-DOCTRINE`.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:46:42.961921Z","updated_at":"2026-02-22T04:05:46.056300Z","closed_at":"2026-02-22T04:05:46.056303Z","ephemeral":false,"dependencies":[{"issue_id":"bd-32","depends_on_id":"bd-31","type":"blocks"},{"issue_id":"bd-32","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-33","title":"[Conformance] Add coherence-contract capability vectors and cross-surface parity checks","description":"Unify coherence and conformance by making coherence-contract checks a first-class executable capability with golden/adversarial/invariance vectors.\nAcceptance:\n- capability fixture suite added,\n- vectors assert parity across docs/code/checker surfaces,\n- included in baseline and hook gates with cache-aware execution.","notes":"Closed after completion of coherence-contract executable parity program.\n\nDelivered slices:\n- `bd-52`: integrated `coherence-contract` into cached fixture-suite runner with deterministic KCIR-style cache refs.\n- CI wrapper parity hardening: added `tools/ci/test_client_transport_parity.py` and wired into `ci-pipeline-test`.\n- `bd-80`: introduced `span_square_commutation` obligation, checker hook, draft spec (`SPAN-SQUARE-CHECKING`), and initial golden/adversarial vectors.\n- `bd-81`: extended span/square vectors with invariance + digest-mismatch adversarial coverage.\n- `bd-82`: enforced per-obligation site vector polarity coverage (`golden/` + `adversarial/`) with deterministic checker failures and unit tests.\n\nContract/doc integration:\n- `COHERENCE-CONTRACT.json`, `PREMATH-COHERENCE.md`, `SPEC-INDEX.md`, `SPEC-TRACEABILITY.md`, `UNIFICATION-DOCTRINE.md`, and decision log entries 0075–0077 updated.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/check_spec_traceability.py`\n\nAcceptance criteria satisfied: coherence-contract vectors are first-class executable capability surfaces, parity checks span docs/code/checker layers, and execution is baseline-gated with deterministic cache-aware suite planning.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:46:42.974344Z","updated_at":"2026-02-22T10:27:19.755634Z","closed_at":"2026-02-22T10:27:19.755636Z","ephemeral":false,"dependencies":[{"issue_id":"bd-33","depends_on_id":"bd-32","type":"blocks"},{"issue_id":"bd-33","depends_on_id":"bd-34","type":"blocks"},{"issue_id":"bd-33","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-33","depends_on_id":"bd-68","type":"blocks","created_by":"codex"}]}
{"id":"bd-34","title":"[Migration Execution] Move Python checker/gate semantics into premath-coherence core (thin wrappers only)","description":"Implementation issue executing the bd-27 migration plan.\nScope:\n- move semantic/check kernels into Rust core,\n- retain Python/provider scripts as thin wrappers,\n- prove deterministic parity before deprecating duplicate Python logic.","notes":"Progress update (2026-02-22): moved `ci.required` verification semantics into core. Added `premath-coherence` required verifier (`verify_required_witness_payload`) covering deterministic projection parity, gate witness linkage/digest validation, native-required source checks, and operational/semantic failure-lineage union checks. Added CLI command `premath required-witness-verify --input <json> --json` and thin Python adapters (`tools/ci/required_witness_verify_client.py`, rewritten `tools/ci/required_witness.py`). Added tests in Rust (`required_verify` unit tests), CLI smoke (`required_witness_verify_json_smoke`), and Python client tests (`tools/ci/test_required_witness_verify_client.py`), plus pipeline wiring update in `.mise.toml`. Validation passed: `cargo test -p premath-coherence`, `cargo test -p premath-cli --test cli_smoke`, `python3 tools/ci/test_required_witness_lineage.py`, `python3 tools/ci/test_required_witness_verify_client.py`, `mise run ci-pipeline-test`.\n\nProgress update (2026-02-22, slice 2): moved `ci.required` decision semantics into core. Added `premath-coherence` decision evaluator (`decide_required_witness_request`) and CLI command `premath required-witness-decide --input <json> --json`. Rewrote `tools/ci/decide_required.py` as a thin adapter over `tools/ci/required_witness_decide_client.py` while keeping path/hash attestation outputs in wrapper layer. Added Rust tests (`required_decide` unit tests), CLI smoke (`required_witness_decide_json_smoke`), Python client tests (`tools/ci/test_required_witness_decide_client.py`), updated `.mise.toml` pipeline test wiring, and updated command/docs surfaces (`AGENTS.md`, `tools/ci/README.md`). Validation passed: `cargo test -p premath-coherence`, `cargo test -p premath-cli --test cli_smoke`, `python3 tools/ci/test_required_witness_decide_client.py`, `mise run ci-pipeline-test`, `cargo clippy --workspace --all-targets -- -D warnings`, `mise run baseline`.\n\nProgress update (2026-02-22, slice 3): moved `Delta -> requiredChecks` projection semantics into core. Added `premath-coherence` projection evaluator (`required_projection`) and CLI command `premath required-projection --input <json> --json`. Rewired `tools/ci/change_projection.py` to thin client/orchestration mode via `tools/ci/required_projection_client.py` (git delta detection remains wrapper responsibility). Updated `required_verify` to consume the same core projection module, removing duplicated projection logic. Added Rust tests for projection vectors, CLI smoke (`required_projection_json_smoke`), Python client tests (`tools/ci/test_required_projection_client.py`), and pipeline wiring update in `.mise.toml`. Recorded Decision 0060 and updated docs surfaces (`AGENTS.md`, `tools/ci/README.md`). Validation passed: `cargo test -p premath-coherence`, `cargo test -p premath-cli --test cli_smoke`, `python3 tools/ci/test_required_projection_client.py`, `mise run ci-pipeline-test`, `cargo clippy --workspace --all-targets -- -D warnings`, `mise run baseline`.\n\nProgress update (2026-02-22, slice 4): migrated git/workspace delta detection into core command surface (`premath required-delta`), rewired `tools/ci/change_projection.py` to thin clients only (`required_delta_client` + `required_projection_client`), added CLI smoke (`required_delta_json_smoke`) + pipeline test coverage (`test_required_delta_client.py`), and recorded Decision 0061. Validation passed: `cargo clippy -p premath-cli --all-targets -- -D warnings`, `cargo test -p premath-cli --test cli_smoke`, `mise run ci-pipeline-test`, `mise run ci-command-surface-check`.\n\nProgress update (2026-02-22, slice 5): moved required decision attestation verification semantics into core (`verify_required_decision_request`) and exposed command surface `premath required-decision-verify --input <json> --json`. Rewired `tools/ci/verify_decision.py` to thin transport over `required_decision_verify_client.py` (path/file resolution only). Added unit tests in `premath-coherence` (`required_decision_verify`), CLI smoke (`required_decision_verify_json_smoke`), Python client tests (`tools/ci/test_required_decision_verify_client.py`), pipeline test wiring in `.mise.toml`, and Decision 0062. Validation passed: `cargo test -p premath-coherence required_decision_verify`, `cargo test -p premath-cli --test cli_smoke`, `cargo clippy -p premath-cli --all-targets -- -D warnings`, `mise run ci-pipeline-test`, `mise run ci-required-attested`.\n\nProgress update (2026-02-22, slice 6): moved required gate-ref projection + fallback payload synthesis into core (`premath-coherence::required_gate_ref`) and exposed command `premath required-gate-ref --input <json> --json`. Rewired Python surfaces to thin transport (`tools/ci/required_gate_ref_client.py`) and updated `run_required_checks.py` + `emit_gate_witness.py` to consume core results instead of local semantic assembly. Added Rust unit tests, CLI smoke (`required_gate_ref_json_smoke`), Python client tests (`test_required_gate_ref_client.py`), `.mise.toml` pipeline wiring, docs updates (AGENTS + CI README), and Decision 0063. Validation passed: `cargo test -p premath-coherence required_gate_ref`, `cargo test -p premath-cli --test cli_smoke required_gate_ref_json_smoke`, `python3 tools/ci/test_required_gate_ref_client.py`, `mise run ci-pipeline-test`.\n\nProgress update (2026-02-22, slice 7): reduced Python wrapper encoding by deduplicating shared required-client transport into `tools/ci/core_cli_client.py` (premath binary resolution, temp-json input handoff, stale local binary retry-to-cargo, deterministic failure-class extraction, and JSON decode/retry handling). Rewired `required_delta/projection/witness/witness_verify/witness_decide/decision_verify/gate_ref` clients to keep only payload-shape validation + command metadata while preserving per-client failure classes. Validation passed: all seven required-client unit suites + `mise run ci-pipeline-test`.\n\nProgress update (2026-02-22, slice 8): moved `tools/ci/proposal_check_client.py` onto shared transport (`core_cli_client.run_core_json_command`) and preserved proposal-specific payload error class mapping (`proposal_nondeterministic`, `proposal_kcir_ref_mismatch`, `proposal_invalid_step`) over shared default transport failures. Validation passed: `python3 tools/ci/test_proposal_check_client.py` and `mise run ci-pipeline-test`.\n\nProgress update (2026-02-22, slice 9): routed instruction clients onto shared transport. `run_instruction_check` now uses core file-input transport (`run_core_json_command_from_path`) and `run_instruction_witness` now uses core payload-input transport (`run_core_json_command`) with preserved pre-execution argument semantics. Extended shared helper with path-input mode, extra arg support, and explicit invalid-json failure-class binding so instruction-check retains `instruction_envelope_invalid_shape` on parse failures. Validation passed: `python3 tools/ci/test_instruction_check_client.py` + `mise run ci-pipeline-test`.\n\nClosure update (2026-02-22): bd-34 migration objective met. Required-gate and instruction semantic checks now run through core command surfaces (`required-*`, `proposal-check`, `instruction-check`, `instruction-witness`) with Python wrappers reduced to transport/orchestration responsibilities. Deterministic parity is covered in CLI smoke + client suites + `ci-pipeline-test`, and pre-push closure gates (`ci-required-attested`) pass on all migration slices.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T02:46:42.984607Z","updated_at":"2026-02-22T09:53:13.770293Z","closed_at":"2026-02-22T09:53:13.770295Z","ephemeral":false,"dependencies":[{"issue_id":"bd-34","depends_on_id":"bd-32","type":"blocks"},{"issue_id":"bd-34","depends_on_id":"bd-27","type":"blocks"},{"issue_id":"bd-34","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-35","title":"[Spec] Unification doctrine for minimum encoding with maximum expressiveness","description":"Author a compact architectural doctrine that formalizes unification/reduction constraints:\n- single authority boundary (checker+witness),\n- minimal encodings with maximal semantic expressiveness,\n- explicit anti-duplication rules for canonicalization/typing/discharge surfaces.\nAcceptance:\n- normative spec section added,\n- traceability + conformance hooks added,\n- design checklist applied to active migration issues.","notes":"Added draft/UNIFICATION-DOCTRINE as the architecture rule for minimum encoding with maximum expressiveness (single canonical authority encoding + deterministic projections). Wired into SPEC-INDEX and draft README, added traceability matrix row (instrumented), and recorded Decision 0036. Baseline/traceability/docs-coherence/coherence checks pass.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T02:46:46.740673Z","updated_at":"2026-02-22T03:40:02.287988Z","closed_at":"2026-02-22T03:40:02.287990Z","ephemeral":false,"dependencies":[{"issue_id":"bd-35","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-36","title":"[Milestone M1] Real backend profile + reference verifier implementation","description":"Track and execute Decision 0001 M1 milestone explicitly: implement at least one real backend profile and reference verifier path (project_ref/verify_ref) with deterministic normalization and Gate obligation discharge.\nAcceptance:\n- one non-toy backend profile implemented,\n- interop-full vectors pass against that profile,\n- witness parity and determinism documented.","notes":"Implemented real profile-backed ref verifier surface and bound interop vectors to canonical CLI path.\n\nShipped:\n- Added profile artifact policies/ref/sha256_detached_v1.json (premath.ref_profile.v1).\n- Added premath-cli commands: `ref project` and `ref verify` with deterministic failure classes.\n- Added CLI smoke tests for both commands.\n- Updated interop-core ref fixtures to use profilePath + pinned profile fields.\n- Updated tools/conformance/run_interop_core_vectors.py to invoke `premath ref project/verify` (no Python digest shim).\n- Updated docs (AGENTS.md command surface, tools/conformance/README) and decision log (Decision 0054).\n\nValidation:\n- cargo test -p premath-cli (pass)\n- python3 tools/conformance/run_interop_core_vectors.py (pass)\n- mise run baseline (pass; includes conformance-run cache summary and full CI/check surface)","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T02:54:04.919869Z","updated_at":"2026-02-22T07:41:32.326939Z","closed_at":"2026-02-22T07:41:32.326942Z","ephemeral":false,"dependencies":[{"issue_id":"bd-36","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-36","depends_on_id":"bd-31","type":"blocks"},{"issue_id":"bd-36","depends_on_id":"bd-38","type":"blocks"}]}
{"id":"bd-37","title":"[Docs] Refresh ROADMAP or deprecate in favor of issue graph + decision log","description":"Resolve roadmap drift in specs/premath/raw/ROADMAP.md by either updating phases to current architecture state (coherence v1, observation, unification/reduction) or deprecating with explicit pointer to active issue graph + decision log as authoritative roadmap.\nAcceptance:\n- roadmap state no longer stale,\n- authoritative planning source is explicit,\n- docs coherence checks cover the chosen source.","notes":"Resolved roadmap drift by deprecating raw/ROADMAP as execution authority and explicitly binding planning authority to `.premath/issues.jsonl` + `specs/process/decision-log.md`. Added docs-coherence invariant in `tools/conformance/check_docs_coherence.py` (ROADMAP authority markers required), added unit coverage in `tools/conformance/test_docs_coherence.py`, and recorded Decision 0037. Verified with `mise run docs-coherence-check` and full `mise run baseline`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T02:54:04.928873Z","updated_at":"2026-02-22T03:43:49.415074Z","closed_at":"2026-02-22T03:43:49.415077Z","ephemeral":false,"dependencies":[{"issue_id":"bd-37","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-38","title":"[Lifecycle] NORMALIZER status alignment (promote to draft or codify raw rationale)","description":"Resolve lifecycle inconsistency where raw/NORMALIZER is normative for Interop Full claims. Decide and implement one path:\nA) promote NORMALIZER to draft with traceability/conformance updates, or\nB) retain raw with explicit rationale + stability policy in SPEC-INDEX/decision-log.\nAcceptance:\n- lifecycle decision recorded,\n- SPEC-INDEX and traceability consistent,\n- conformance references aligned.","notes":"Promoted NORMALIZER from raw to draft lifecycle (moved to specs/premath/draft/NORMALIZER.md, status= draft), rewired Interop Full and cross-spec references to draft/NORMALIZER, and added NORMALIZER.md to SPEC-TRACEABILITY with executable coverage mapping. Baseline and traceability checks pass (draftSpecs=22, matrixRows=22).","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:54:04.939724Z","updated_at":"2026-02-22T03:33:24.487751Z","closed_at":"2026-02-22T03:33:24.487752Z","ephemeral":false,"dependencies":[{"issue_id":"bd-38","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-39","title":"[Lifecycle] Optional capability raw-spec promotion policy (SQUEAK-SITE, TUSK-CORE)","description":"Define lifecycle policy for optional capability specs currently in raw status but actively exercised by conformance claims.\nScope:\n- raw/SQUEAK-SITE\n- raw/TUSK-CORE\nAcceptance:\n- explicit promote/retain criteria,\n- issue-backed promotion queue where applicable,\n- SPEC-INDEX wording aligned with policy.","notes":"Defined explicit optional raw capability-spec lifecycle policy in `draft/SPEC-INDEX` §5.5 (retain-vs-promote criteria + capability-scoped normative boundary). Added issue-backed promotion queue entries `bd-44` (raw/SQUEAK-SITE) and `bd-45` (raw/TUSK-CORE) with dependency edges into bd-39/bd-28. Added docs-coherence enforcement for raw lifecycle policy markers and roadmap authority markers in `tools/conformance/check_docs_coherence.py`, expanded parser tests, and recorded Decision 0038. Verified with `mise run docs-coherence-check` and full `mise run baseline`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T02:54:12.117121Z","updated_at":"2026-02-22T03:45:33.213115Z","closed_at":"2026-02-22T03:45:33.213117Z","ephemeral":false,"dependencies":[{"issue_id":"bd-39","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-39","depends_on_id":"bd-37","type":"blocks"}]}
{"id":"bd-4","title":"[EPIC] Coherence v1: Instruction-Governed Multiagent Control Plane","description":"Consolidate issue memory, instruction envelopes, policy/capability boundaries, and checker-discharge outputs into one auditable control plane where agents propose and the checker decides.","notes":"Coherence v1 epic closed after bd-10 completion. Completed stack: policy artifact registry, proposal->obligations->discharge witness surface, pre-execution reject witnesses, capability-gated mutation policy, multiagent claim/lease protocol, adjoints/sites capability vectors, and observation coherence dashboard + attention projections.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-21T23:06:40.461429Z","updated_at":"2026-02-22T01:24:24.967995Z","closed_at":"2026-02-22T01:24:24.967997Z","ephemeral":false}
{"id":"bd-40","title":"[EPIC] Issue System v2: deterministic task memory, workflows, and multiagent orchestration","description":"Upgrade the issue system into a first-class deterministic control substrate (not just a backlog list).\nScope:\n- unify issue state with append-only event memory and projection reducers,\n- enrich dependency semantics (blocks/conditional/waits-for/parental views) without ambiguity,\n- integrate claim/lease lifecycles and contention/staleness handling as first-class typed transitions,\n- support workflow views (execution graph, GTD/task modes) as derived projections,\n- bind issue mutations to instruction/witness authority boundaries.\nAcceptance:\n1) v2 issue-memory spec + migration strategy,\n2) deterministic reducers + invariance vectors,\n3) doctrine-gated mutation surface with typed witnesses,\n4) observation projections for orchestration health and flow coherence.","notes":"Issue System v2 acceptance is satisfied on one canonical substrate with deterministic projections:\n1) v2 issue-memory spec + migration strategy: implemented `issue.event.v1` migration/replay boundaries (`premath issue migrate-events`, `premath issue replay-events`) with deterministic refs/cache semantics (bd-41, bd-29, bd-30; Decisions 0030/0032/0033).\n2) deterministic reducers + invariance vectors: event replay equivalence, cache invariance, dependency projection views, and change_morphisms vectors are executable and baseline-gated.\n3) doctrine-gated mutation surface with typed witnesses: issue/dep mutations are instruction-linked capability-gated with deterministic reject/accept witness behavior.\n4) orchestration health projections: claim/lease state machine + stale/contention projections are implemented and exposed via observation/issue projection surfaces (bd-43 and coherence/observation checks).\nThe epic remains discovered-from bd-28 as part of the broader unification program, but Issue System v2 scope itself is complete.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:56:05.223559Z","updated_at":"2026-02-22T03:48:31.661357Z","closed_at":"2026-02-22T03:48:31.661360Z","ephemeral":false,"dependencies":[{"issue_id":"bd-40","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-41","title":"[Issue v2] Event schema v1 + migration from issues JSONL","description":"Define canonical issue-memory event schema (`issue.event.v1`) and migration path from `.premath/issues.jsonl` snapshots to append-only events.\nAcceptance:\n- schema + invariants documented,\n- deterministic migration tool emits identical logical issue state after replay,\n- backfill/provenance fields preserved (created/updated/closed/dependency mutations).","notes":"Implemented issue.event.v1 in premath-bd with deterministic migration from snapshot JSONL, event JSONL read/write, replay, deferred dependency resolution, and replay equivalence check. Added CLI subcommand `premath issue migrate-events` with replay verification and JSON output. Added unit tests in premath-bd and CLI smoke test. Verified with `cargo test -p premath-bd` and `cargo test -p premath-cli`.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T02:56:53.018386Z","updated_at":"2026-02-22T03:03:26.850681Z","closed_at":"2026-02-22T03:03:26.850683Z","ephemeral":false,"dependencies":[{"issue_id":"bd-41","depends_on_id":"bd-40","type":"discovered-from"}]}
{"id":"bd-42","title":"[Issue v2] Dependency semantics v2 + projection views (execution/GTD/groupoid)","description":"Refine dependency model semantics and expose multiple deterministic projections over one substrate.\nScope:\n- clarify semantics for blocks/conditional-blocks/waits-for/parent-child/discovered-from,\n- add projection views for execution readiness, GTD-style workflow buckets, and higher-order relation views.\nAcceptance:\n- semantics spec + compatibility rules,\n- deterministic projection reducers,\n- conformance vectors for semantic invariance and edge-case conflict handling.","notes":"Implemented dependency semantics v2 projections with minimal encoding: canonical DepType retained; added DependencyView (execution/gtd/groupoid), deterministic role mapping, and projection rows in premath-bd. Added CLI subcommand `premath dep project --view <execution|gtd|groupoid>`. Added unit tests for view role mapping and CLI smoke coverage for dep project views. Verified with `cargo test -p premath-bd` and `cargo test -p premath-cli`.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T02:56:53.110400Z","updated_at":"2026-02-22T03:05:01.705433Z","closed_at":"2026-02-22T03:05:01.705436Z","ephemeral":false,"dependencies":[{"issue_id":"bd-42","depends_on_id":"bd-40","type":"discovered-from"},{"issue_id":"bd-42","depends_on_id":"bd-41","type":"blocks"}]}
{"id":"bd-43","title":"[Issue v2] Lease/workflow state machine + orchestration invariance vectors","description":"Formalize issue mutation lifecycle as a typed state machine and prove deterministic orchestration behavior under contention.\nScope:\n- claim/renew/release transitions + failure-class mapping,\n- stale/contended lease projections and repair semantics,\n- witness-linked mutation authorization contract.\nAcceptance:\n- state-machine spec + implementation,\n- adversarial vectors for contention/stale/owner-mismatch/id-mismatch,\n- observation projections expose orchestration health deterministically.","notes":"Implemented lease/workflow state-machine coherence tightening across runtime + vectors: (1) added MCP tests for stale-lease reclaim reassignment and explicit invalid TTL/expiry rejection; (2) aligned change_morphisms conformance evaluator with runtime lease semantics (stale reclaim, lease binding ambiguity, TTL range, future expiry checks, runtime lease-id tokenization); (3) added new vectors for stale reclaim golden path and invalid claim expiry/ttl adversarial paths. Verified via `python3 tools/conformance/run_capability_vectors.py --capability capabilities.change_morphisms` and `cargo test -p premath-cli`.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-22T02:56:53.132249Z","updated_at":"2026-02-22T03:16:59.289744Z","closed_at":"2026-02-22T03:16:59.289764Z","ephemeral":false,"dependencies":[{"issue_id":"bd-43","depends_on_id":"bd-40","type":"discovered-from"},{"issue_id":"bd-43","depends_on_id":"bd-41","type":"blocks"}]}
{"id":"bd-44","title":"[Lifecycle Queue] raw/SQUEAK-SITE promotion readiness gate","description":"Prepare and decide lifecycle path for raw/SQUEAK-SITE under the new optional raw capability promotion policy.\nAcceptance:\n- map every claimed site law boundary to deterministic capability vectors,\n- verify deterministic witness/failure-class mapping across instruction/CI/runtime surfaces,\n- either promote to draft with traceability updates or record explicit raw-retain rationale in decision log.","notes":"Completed SQUEAK-SITE promotion-readiness gate and selected raw-retain lifecycle path.\nDelivered:\n- Added missing adversarial law-boundary coverage for `site_glue_missing` via new vector `adversarial/site_glue_missing_reject` (manifest + fixture pair + evaluator routing in `run_capability_vectors.py`).\n- Updated `draft/CAPABILITY-VECTORS` §2.8 required-when-claimed list to include `site_glue_missing` deterministic rejection.\n- Added explicit law-boundary -> executable vector mapping section in `raw/SQUEAK-SITE` covering descriptor determinism, overlap agreement/mismatch, glue missing/non-contractible, capability claim gating, and profile invariance.\n- Recorded lifecycle decision to retain `raw/SQUEAK-SITE` for now with tightened capability-scoped deterministic boundaries (Decision 0040).\nValidation: `python3 tools/conformance/check_stub_invariance.py`, `python3 tools/conformance/run_capability_vectors.py --capability capabilities.squeak_site`, and full `mise run baseline` all pass.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T03:44:50.978325Z","updated_at":"2026-02-22T03:50:49.850384Z","closed_at":"2026-02-22T03:50:49.850388Z","ephemeral":false,"dependencies":[{"issue_id":"bd-44","depends_on_id":"bd-39","type":"discovered-from"},{"issue_id":"bd-44","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-45","title":"[Lifecycle Queue] raw/TUSK-CORE promotion readiness gate","description":"Prepare and decide lifecycle path for raw/TUSK-CORE under the new optional raw capability promotion policy.\nAcceptance:\n- define capability-scoped normative boundary for tusk runtime contracts,\n- add deterministic vectors and witness/failure mappings for that boundary,\n- either promote to draft with traceability updates or record explicit raw-retain rationale in decision log.","notes":"Completed TUSK-CORE promotion-readiness gate and selected raw-retain lifecycle path.\nDelivered:\n- Added dedicated deterministic fixture suite `tusk-core` (`tests/conformance/fixtures/tusk-core`) with executable runner `tools/conformance/run_tusk_core_vectors.py` and integrated it into cached `conformance-run` (`run_fixture_suites.py`).\n- Added explicit boundary vectors for accepted + mapped failure outcomes:\n  - no locals -> `locality_failure` (`GATE-3.2`),\n  - multi-local missing compat -> `locality_failure` (`GATE-3.2`),\n  - no glue proposals -> `descent_failure` (`GATE-3.3`),\n  - missing mode binding -> `descent_failure` (`GATE-3.3`),\n  - multi-proposal ambiguity -> `glue_non_contractible` (`GATE-3.4`).\n- Added `raw/TUSK-CORE` conformance mapping section tying runtime clauses to concrete vectors and Gate-class/lawRef evidence.\n- Updated lifecycle policy queue note in `draft/SPEC-INDEX` and recorded raw-retain rationale as Decision 0041.\nValidation: `python3 tools/conformance/run_tusk_core_vectors.py`, `python3 tools/conformance/run_fixture_suites.py`, and full `mise run baseline` pass.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-22T03:44:50.990135Z","updated_at":"2026-02-22T03:59:04.143449Z","closed_at":"2026-02-22T03:59:04.143452Z","ephemeral":false,"dependencies":[{"issue_id":"bd-45","depends_on_id":"bd-39","type":"discovered-from"},{"issue_id":"bd-45","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-46","title":"[Migration Follow-up] Route capability proposal vector evaluation through core proposal-check parity path","description":"Continue bd-34 migration by removing remaining Python-local proposal semantic authority in capability vector evaluators (instruction_typing/adjoints_sites proposal checks) and routing them through the same core-backed proposal checker path used by run_instruction.\nAcceptance:\n- vector evaluator uses core-backed proposal-check API/command for canonicalize + obligations + discharge,\n- deterministic parity vs current fixtures preserved,\n- no duplicated proposal compile/discharge semantics remain in tools/conformance for these paths.","notes":"Completed: routed capability proposal vector evaluation through core premath proposal-check path via shared tools/ci/proposal_check_client.py; removed Python-side proposal compile/discharge authority from conformance evaluator; verified with ci-pipeline-test + conformance-run + baseline.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T04:19:36.642930Z","updated_at":"2026-02-22T04:25:04.577933Z","closed_at":"2026-02-22T04:25:04.577935Z","ephemeral":false,"dependencies":[{"issue_id":"bd-46","depends_on_id":"bd-34","type":"discovered-from"}]}
{"id":"bd-47","title":"[Migration Follow-up] Retire legacy Python proposal semantic shim","description":"`tools/ci/instruction_proposal.py` still carries Python-local canonicalize/digest/obligation/discharge semantics that are no longer authoritative after core cutover. Minimize encoding by reducing this surface to extraction-only (or removing it), update tests accordingly, and enforce core proposal-check as single semantic authority.","notes":"Completed: moved scope_noncontradiction bidir checker map introspection to core-owned source (`crates/premath-coherence/src/proposal.rs`) via COHERENCE-CONTRACT update; added core `OBLIGATION_TO_GATE_FAILURE` constant and parser support for Rust tuple map form; removed map shim from `tools/ci/instruction_proposal.py`. Verified with cargo test -p premath-coherence, ci-pipeline-test, and full baseline.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T04:30:36.458385Z","updated_at":"2026-02-22T04:39:05.967687Z","closed_at":"2026-02-22T04:39:05.967689Z","ephemeral":false,"dependencies":[{"issue_id":"bd-47","depends_on_id":"bd-34","type":"blocks"},{"issue_id":"bd-47","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-48","title":"[Conformance Cache Parity] Include doctrine-inf fixtures in cached suite runner + hook path","description":"Close fixture coverage drift by executing doctrine-inf vectors through `tools/conformance/run_fixture_suites.py` (KCIR cache path) instead of only uncached standalone invocation.\nAcceptance:\n- add doctrine-inf suite to cached fixture runner,\n- keep doctrine site structural check as separate fast invariant,\n- baseline/hook path still executes doctrine-inf semantics with deterministic cache-aware behavior,\n- docs updated so executable fixture surfaces are coherent.","notes":"Completed doctrine-inf cache parity slice.\nDelivered:\n- Added `doctrine-inf` suite to `tools/conformance/run_fixture_suites.py` so doctrine-inf fixtures execute on the KCIR-style cache path (`kcir.cache.fixture-suite.v1`).\n- Updated conformance fixture docs to reflect doctrine-inf as executable and included in the cached multi-suite surface.\nValidation:\n- `python3 tools/conformance/run_fixture_suites.py --suite doctrine-inf --no-cache`\n- `mise run conformance-run`\n- `python3 tools/conformance/check_docs_coherence.py`\n- `mise run doctrine-check`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T04:43:22.230306Z","updated_at":"2026-02-22T04:44:19.658617Z","closed_at":"2026-02-22T04:44:19.658620Z","ephemeral":false,"dependencies":[{"issue_id":"bd-48","depends_on_id":"bd-19","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-48","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-49","title":"[Command Surface Reduction] Route doctrine-check doctrine-inf execution through cached fixture-suite runner","description":"Preserve doctrine-check semantics while eliminating duplicate doctrine-inf execution surfaces.\nAcceptance:\n- doctrine-check keeps doctrine-site structural check,\n- doctrine-inf execution in doctrine-check runs via `tools/conformance/run_fixture_suites.py --suite doctrine-inf` (shared cache path),\n- conformance-run reuses the same suite path and hits cache,\n- issue/docs notes updated for coherent command surface intent.","notes":"Completed command-surface reduction for doctrine-inf execution.\nDelivered:\n- `mise run doctrine-check` now executes doctrine-inf vectors through the shared cached suite runner (`python3 tools/conformance/run_fixture_suites.py --suite doctrine-inf`) instead of a separate direct script path.\n- Preserved doctrine-check intent (site structural coherence + doctrine-inf semantics) while unifying execution on one cache-aware evaluator surface.\n- Added docs/tooling coherence invariant in `tools/conformance/check_docs_coherence.py` to pin the doctrine-check command surface to this unified path, plus parser test coverage in `tools/conformance/test_docs_coherence.py`.\nValidation:\n- `mise run doctrine-check`\n- `mise run conformance-run`\n- `mise run ci-command-surface-check`\n- `python3 tools/conformance/check_docs_coherence.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T04:46:34.992053Z","updated_at":"2026-02-22T04:47:57.248095Z","closed_at":"2026-02-22T04:46:55.944115Z","ephemeral":false,"dependencies":[{"issue_id":"bd-49","depends_on_id":"bd-48","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-49","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-5","title":"[Coherence v1] Policy Artifact Registry + Digest Verification","description":"Replace hardcoded instruction check allowlists with canonical policy artifacts (JSON) whose content hash equals policyDigest. Checker/runner must resolve policy by digest and reject unknown or mismatched policies fail-closed.","notes":"Completed. Replaced hardcoded instruction policy allowlist with canonical policy artifact registry under policies/instruction/*.json. Enforced policyDigest as canonical pol1 digest, validated artifact digest integrity, validated requestedChecks allowlist and normalizer allowlist, updated instruction/conformance fixtures to digest policy bindings, and passed full baseline.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-21T23:06:48.462046Z","updated_at":"2026-02-21T23:26:34.442335Z","closed_at":"2026-02-21T23:26:34.442336Z","ephemeral":false,"dependencies":[{"issue_id":"bd-5","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-50","title":"[Migration Follow-up] Retire Python instruction_policy shim and align tests to core instruction-check","description":"Now that instruction envelope policy/normalizer validation is core-owned (`premath instruction-check`) across runtime, MCP, and capability vectors, remove residual Python `tools/ci/instruction_policy.py` semantic authority and replace/realign remaining tests/docs to assert core behavior only.\nAcceptance:\n- no production/conformance path imports `instruction_policy`,\n- CI tests cover policy/allowlist failures via core instruction-check client/CLI,\n- docs no longer present instruction_policy as an authority boundary.","notes":"Completed retirement of legacy Python instruction-policy shim.\n\nShipped:\n- Removed `tools/ci/instruction_policy.py` (legacy duplicate semantic authority).\n- Removed `tools/ci/test_instruction_policy.py`.\n- Updated `mise` pipeline test surface to drop removed test (`.mise.toml`).\n- Updated spec traceability mapping for `draft/LLM-PROPOSAL-CHECKING` to core-backed tests:\n  - `tools/ci/test_instruction_check_client.py`\n  - `tools/ci/test_instruction_reject_witness.py`\n- Recorded boundary decision in `specs/process/decision-log.md` (Decision 0055).\n\nValidation:\n- `mise run ci-pipeline-test` (pass)\n- `python3 tools/conformance/check_spec_traceability.py` (pass)\n- `mise run baseline` (pass)","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:04:28.668061Z","updated_at":"2026-02-22T07:47:54.290722Z","closed_at":"2026-02-22T07:47:54.290725Z","ephemeral":false,"dependencies":[{"issue_id":"bd-50","depends_on_id":"bd-34","type":"blocks"},{"issue_id":"bd-50","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-51","title":"[Coherence] Functorial transport contract: base/fibre identity, composition, and naturality","description":"Add a first-class coherence transport artifact and checker path so base-space projections are constrained to transform functorially with fibre-space transformations.\nAcceptance:\n- deterministic transport artifact schema in premath-coherence checker path,\n- coherence obligation enforcing identity/composition/naturality equalities over canonicalized payloads,\n- golden/adversarial transport fixtures wired into coherence-check baseline gate,\n- witness details include per-law digests and failing vector IDs.","notes":"Implemented first-class transport coherence machinery in the authoritative checker path.\nDelivered:\n- Added new required coherence obligation `transport_functoriality` in `premath-coherence` and contract wiring in `specs/premath/draft/COHERENCE-CONTRACT.json`.\n- Added deterministic transport evaluation over typed fixture artifacts with semantic canonicalization (`normalize_semantics`) and digesting (`sem1_...`) for three laws: identity, composition, naturality.\n- Added executable fixture suite `tests/conformance/fixtures/coherence-transport` with golden/adversarial/invariance vectors and expected failure-class assertions.\n- Added unit coverage in `crates/premath-coherence/src/lib.rs` for semantic digest invariance and identity-violation detection.\nValidation: `cargo test -p premath-coherence`, `mise run coherence-check`, and full `mise run baseline` all pass.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:11:06.044009Z","updated_at":"2026-02-22T05:16:25.701339Z","closed_at":"2026-02-22T05:16:25.701341Z","ephemeral":false,"dependencies":[{"issue_id":"bd-51","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-51","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-52","title":"[Coherence Glue] Route coherence-contract transport vectors through cached fixture-suite runner","description":"Integrate coherence transport vectors into the shared cache-aware conformance fixture suite surface to reduce duplicate execution paths and tighten cross-surface parity.\nAcceptance:\n- add a coherence-contract fixture suite entry in `tools/conformance/run_fixture_suites.py` that runs the authoritative `premath coherence-check` command,\n- cache binding includes coherence checker code + contract + coherence transport fixtures,\n- docs/fixtures references reflect the new suite,\n- deterministic cache hit behavior verified for the new suite,\n- baseline remains green.","notes":"Completed: integrated coherence-contract transport checks into the shared cached fixture-suite surface.\nDelivered:\n- Added `coherence-contract` suite in `tools/conformance/run_fixture_suites.py` executing authoritative command `premath coherence-check --contract specs/premath/draft/COHERENCE-CONTRACT.json --repo-root . --json`.\n- Bound cache materialization to coherence contract artifact, transport fixtures, and core checker/CLI sources.\n- Updated fixture/conformance docs (`tests/conformance/fixtures/README.md`, `tools/conformance/README.md`) to include the new suite.\n- Recorded boundary decision in `specs/process/decision-log.md` (Decision 0044).\nValidation:\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract` (store)\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract` (hit)\n- `mise run conformance-run`\n- `mise run baseline`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:20:36.420799Z","updated_at":"2026-02-22T05:22:00.431818Z","closed_at":"2026-02-22T05:22:00.431822Z","ephemeral":false,"dependencies":[{"issue_id":"bd-52","depends_on_id":"bd-33","type":"discovered-from"},{"issue_id":"bd-52","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-53","title":"[Site Semantics] Add Ctx/J, sheaf-stack, and torsor-extension raw specs with foundations companion","description":"Capture the Premath site/topos abstraction with minimum encoding and maximum expressiveness as raw specs tied to existing kernel/coherence doctrine.\nAcceptance:\n- add raw docs for Ctx base category + coverage topology, presheaf/sheaf/stack contracts, and torsor/extension equivalence,\n- add one foundations note that explains the intuition and implementation mapping,\n- update SPEC-INDEX and raw README references coherently,\n- keep authority split explicit: these docs are informational unless promoted/claimed.","notes":"Completed site/topos semantics documentation slice with foundations companion.\nDelivered:\n- Added raw specs:\n  - `specs/premath/raw/CTX-SITE.md`\n  - `specs/premath/raw/SHEAF-STACK.md`\n  - `specs/premath/raw/TORSOR-EXT.md`\n- Added foundations explainer:\n  - `docs/foundations/SITE-AND-TORSOR-NOTES.md`\n- Updated discoverability/indexing:\n  - `specs/premath/raw/README.md`\n  - `specs/premath/draft/SPEC-INDEX.md` (§5.5 informative list)\n- Recorded architecture boundary decision:\n  - Decision 0045 in `specs/process/decision-log.md`.\nValidation:\n- `mise run docs-coherence-check`\n- `mise run traceability-check`\n- `mise run coherence-check`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:24:59.660073Z","updated_at":"2026-02-22T05:26:43.097367Z","closed_at":"2026-02-22T05:26:43.097371Z","ephemeral":false,"dependencies":[{"issue_id":"bd-53","depends_on_id":"bd-28","type":"discovered-from"},{"issue_id":"bd-53","depends_on_id":"bd-33","type":"discovered-from"}]}
{"id":"bd-54","title":"[Coherence] Add site-coverage and glue-or-witness obligations with coherence-site vectors","description":"Implement the next coherence-contract domain beyond transport:\n- coverage base-change stability,\n- coverage transitivity,\n- glue-or-witness contractibility.\nAcceptance:\n- add required obligations in core checker + contract artifact,\n- add executable fixtures under `tests/conformance/fixtures/coherence-site` (golden/adversarial/invariance),\n- include coherence-site fixture root in cached coherence-contract suite inputs,\n- coherence-check and conformance-run pass deterministically.","notes":"Implemented coherence-site obligations in premath-coherence: coverage_base_change, coverage_transitivity, glue_or_witness_contractibility; added deterministic vector runner over tests/conformance/fixtures/coherence-site; added golden/adversarial/invariance fixtures and manifest; extended COHERENCE-CONTRACT + PREMATH-COHERENCE + conformance docs + decision log; wired coherence-site into run_fixture_suites cache surface; added foundations grounding note in docs/foundations/SITE-AND-TORSOR-NOTES.md; verified with cargo test -p premath-coherence, mise run coherence-check, python3 tools/conformance/run_fixture_suites.py --suite coherence-contract, and mise run conformance-run.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:28:48.724493Z","updated_at":"2026-02-22T05:35:41.756178Z","closed_at":"2026-02-22T05:35:41.756181Z","ephemeral":false,"dependencies":[{"issue_id":"bd-54","depends_on_id":"bd-33","type":"discovered-from"},{"issue_id":"bd-54","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-55","title":"[Governance] Enforce server-side required CI attestation on main (no bypass path)","description":"Git push reported local ci-required-attested success but remote accepted push with \"Bypassed rule violations ... Required status check ci-required is expected\". Harden branch protection/repo rules so merges/pushes to main require verified CI witness + required status without bypass, aligning with doctrine of deterministic gate authority and preventing unchecked public drift.","notes":"Closed by bd-64 rollout completion + bd-65 checker hardening.\nResults:\n- `main` now enforces PR-only updates and required `ci-required` status without admin bypass (`enforce_admins=true`).\n- Policy checker now verifies both ruleset and classic branch-protection surfaces deterministically, including admin bypass detection.\n- Live branch-policy workflow pass recorded: https://github.com/workingdoge/premath/actions/runs/22272381740\n- Active fix PR: https://github.com/workingdoge/premath/pull/8","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:37:14.633502Z","updated_at":"2026-02-22T06:57:18.482858Z","closed_at":"2026-02-22T06:57:18.482862Z","ephemeral":false,"dependencies":[{"issue_id":"bd-55","depends_on_id":"bd-64","type":"blocks"}]}
{"id":"bd-56","title":"[EPIC] Doctrine boundary de-adhoc: single-source authority maps across kernel/coherence/CI","description":"Generalization of bd-28 unification through DOCTRINE-INF: eliminate parallel encodings of semantic/control-plane authority boundaries. Goal: one canonical typed authority map per boundary (obligation->Gate mapping, capability->policy/check surface, doctrine-site reachability), with deterministic projections consumed by kernel, coherence, CI wrappers, and conformance vectors.","notes":"Closed after completion of planned execution chain:\n- bd-57: kernel-owned obligation->Gate registry authority export,\n- bd-63: shared control-plane contract artifact consumption,\n- bd-58: typed-registry parity cutover (remove source scraping),\n- bd-59: CI operational vs semantic failure lineage split,\n- bd-60: doctrine-site generation-first with roundtrip checks,\n- bd-61: cross-surface boundary-authority invariance vectors (registry/proposal/coherence/CI + stale generated adversarial).\nOutcome: canonical typed authority maps now drive kernel/coherence/CI/conformance surfaces for doctrine boundary scope in this epic.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:33.027728Z","updated_at":"2026-02-22T07:31:08.064192Z","closed_at":"2026-02-22T07:31:08.064194Z","ephemeral":false,"dependencies":[{"issue_id":"bd-56","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-57","title":"[Kernel] Canonicalize obligation→Gate failure mapping as exported authority registry","description":"Move obligation-kind to Gate failure/law mapping into kernel-owned typed registry (not duplicated in proposal/coherence/Python). Expose stable machine-readable export (Rust API + JSON artifact) and make downstream consumers import it. Includes mapping tests against BIDIR-DESCENT §8.1 and GATE §4 classes.","notes":"Completed.\nDelivered:\n- Added kernel-owned canonical registry `crates/premath-kernel/src/obligation_registry.rs` as single authority for obligation->Gate failure mapping (`OBLIGATION_TO_GATE_FAILURE`).\n- Exported typed Rust APIs (`obligation_to_failure_class`, `failure_class_to_law_ref`, `obligation_gate_registry`, `obligation_gate_registry_json`).\n- Added machine JSON export command surface: `premath obligation-registry --json`.\n- Rewired `premath-coherence` proposal discharge to consume kernel registry APIs (removed local mapping authority from `crates/premath-coherence/src/proposal.rs`).\n- Updated coherence contract parity surface to source checker mapping from kernel registry file (`specs/premath/draft/COHERENCE-CONTRACT.json` bidirCheckerPath).\n- Added normative docs + governance log updates: `draft/PREMATH-KERNEL`, `draft/PREMATH-COHERENCE`, Decision 0047.\nValidation:\n- `cargo test -p premath-kernel -p premath-coherence -p premath-cli`\n- `mise run coherence-check`\n- `mise run docs-coherence-check`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:36.778498Z","updated_at":"2026-02-22T06:00:58.588602Z","closed_at":"2026-02-22T06:00:58.588603Z","ephemeral":false,"dependencies":[{"issue_id":"bd-57","depends_on_id":"bd-56","type":"discovered-from"},{"issue_id":"bd-57","depends_on_id":"bd-62","type":"blocks"}]}
{"id":"bd-58","title":"[Coherence] Replace source-text scraping parity checks with typed registry inputs","description":"Refactor premath-coherence checks that parse source/spec text by regex for capability/check/obligation parity into typed artifact consumption. Keep docs parity checks where needed, but authority parity must read canonical registry artifacts. Goal: deterministic parity without language-specific parser fragility or hidden drift.","notes":"Completed source-scrape removal for premath-coherence parity checks: capability parity now consumes typed `draft/CAPABILITY-REGISTRY.json`; bidir checker obligation parity now consumes kernel typed registry API (`obligation_gate_registry*`). Updated conformance/docs parity tooling to the same typed capability registry path and added decision-log + spec index/traceability updates. Validation run: cargo test -p premath-coherence; python3 tools/conformance/test_docs_coherence.py; python3 tools/conformance/check_docs_coherence.py; python3 tools/conformance/check_spec_traceability.py; python3 tools/conformance/run_capability_vectors.py; premath coherence-check accepted.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:40.682837Z","updated_at":"2026-02-22T06:30:20.597766Z","closed_at":"2026-02-22T06:30:20.597768Z","ephemeral":false,"dependencies":[{"issue_id":"bd-58","depends_on_id":"bd-56","type":"discovered-from"},{"issue_id":"bd-58","depends_on_id":"bd-57","type":"blocks"},{"issue_id":"bd-58","depends_on_id":"bd-63","type":"blocks"}]}
{"id":"bd-59","title":"[CI] Preserve semantic failure lineage in ci.required/ci.instruction witnesses","description":"Reduce coarse 'check_failed' collapse by threading gate witness class lineage into required/instruction witness summaries where available, while preserving control-plane failure classes. Define typed split: semantic Gate classes vs operational pipeline classes, and verify deterministic mapping in ci verify/decision paths.","notes":"Completed.\nDelivered:\n- Added typed failure-lineage split to CI witness summaries:\n  - `operationalFailureClasses`\n  - `semanticFailureClasses`\n  - `failureClasses` remains deterministic union compatibility field.\n- `ci.required` lineage threading:\n  - `tools/ci/run_required_checks.py` now records per-check gate `failureClasses` on each `gateWitnessRef` (derived from gate payload `failures[].class`).\n  - top-level `semanticFailureClasses` now unions gate-ref classes where available.\n  - top-level `operationalFailureClasses` preserves control-plane class (`check_failed` when checks fail).\n- Deterministic verifier mapping enforcement:\n  - `tools/ci/required_witness.py` now verifies:\n    - gate ref `failureClasses` parity with payload failure classes,\n    - operational class surface parity with executed result status,\n    - semantic class surface parity with gate witness lineage,\n    - `failureClasses == union(operational, semantic)`.\n  - this enforcement is consumed by both `ci-verify-required` and `ci-decide-required` via existing shared verifier path.\n- `ci.instruction` lineage split:\n  - `tools/ci/run_instruction.py` now emits operational/semantic split fields for both pre-execution reject witnesses and normal instruction runs.\n  - proposal-discharge rejection classes are surfaced via `semanticFailureClasses`; control-plane classes remain operational.\n- Added deterministic unit coverage:\n  - new `tools/ci/test_required_witness_lineage.py`.\n  - extended instruction reject/smoke tests for new split fields.\n  - wired new test into `mise run ci-pipeline-test`.\n- Updated docs/spec language:\n  - `tools/ci/README.md`\n  - `specs/premath/raw/PREMATH-CI.md`\n  - `specs/premath/raw/CI-TOPOS.md`\n  - `specs/premath/draft/LLM-INSTRUCTION-DOCTRINE.md`\n  - decision log `Decision 0049`.\nValidation:\n- `python3 tools/ci/test_required_witness_lineage.py`\n- `python3 tools/ci/test_instruction_reject_witness.py`\n- `python3 tools/ci/test_instruction_smoke.py --instruction tests/ci/fixtures/instructions/20260221T010000Z-ci-wiring-golden.json`\n- `mise run ci-pipeline-test`\n- `mise run ci-observation-test`\n- `mise run docs-coherence-check`\n- `mise run traceability-check`\n- `mise run coherence-check`\n- `mise run conformance-run`\nFollow-on:\n- `bd-61` remains open for cross-surface boundary-authority invariance vectors after remaining blockers (`bd-58`, `bd-60`).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:44.323030Z","updated_at":"2026-02-22T06:20:24.398988Z","closed_at":"2026-02-22T06:20:24.398990Z","ephemeral":false,"dependencies":[{"issue_id":"bd-59","depends_on_id":"bd-56","type":"discovered-from"},{"issue_id":"bd-59","depends_on_id":"bd-57","type":"blocks"},{"issue_id":"bd-59","depends_on_id":"bd-63","type":"blocks"}]}
{"id":"bd-6","title":"[Coherence v1] Proposal -> Obligations -> Discharge Witness Surface","description":"Extend instruction proposal ingestion so output includes obligations[] and discharge[] artifacts, not only proposal digest/classification. Ensure LLM proposals remain checking-mode only and acceptance is discharge-determined.","notes":"Implemented proposal -> obligations -> discharge witness surface in instruction runtime and conformance vectors. Added deterministic compile/discharge functions (tools/ci/instruction_proposal.py), proposal discharge gating in tools/ci/run_instruction.py, and witness emission of proposalIngest.obligations + proposalIngest.discharge. Added adversarial vectors for ext_gap -> descent_failure and ext_ambiguous -> glue_non_contractible determinism checks under capabilities.instruction_typing.","status":"closed","priority":1,"issue_type":"task","created_at":"2026-02-21T23:06:51.520507Z","updated_at":"2026-02-21T23:32:55.730409Z","closed_at":"2026-02-21T23:32:55.730411Z","ephemeral":false,"dependencies":[{"issue_id":"bd-6","depends_on_id":"bd-5","type":"blocks"},{"issue_id":"bd-6","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-60","title":"[Doctrine-Site] Make doctrine operation map generation-first with roundtrip checks","description":"Replace hand-maintained doctrine-site drift surface with generation-first flow from declaration-bearing specs + operation registry, then verify roundtrip and deterministic digest. Keep manual edit escape hatch only behind explicit fail-closed checks. Goal: doctrine ancestry remains auditable with minimal hand-edited duplication.","notes":"Completed generation-first doctrine-site authority path.\nDelivered:\n- Added typed source artifacts:\n  - `specs/premath/draft/DOCTRINE-SITE-SOURCE.json` (non-operation topology)\n  - `specs/premath/draft/DOCTRINE-OP-REGISTRY.json` (operation nodes + CI operation edges)\n- Added shared generation/validation module: `tools/conformance/doctrine_site_contract.py`.\n- Added generator CLI: `tools/conformance/generate_doctrine_site.py`.\n- Refactored `tools/conformance/check_doctrine_site.py` to enforce roundtrip drift check (`generated == tracked`) and retain declaration/morphism/cover/reachability checks.\n- Regenerated canonical `specs/premath/draft/DOCTRINE-SITE.json` deterministically from source + operation registry + declaration-bearing specs.\n- Added deterministic tests: `tools/conformance/test_doctrine_site_contract.py` and wired it into `mise run ci-pipeline-test`.\n- Updated specs/docs: `draft/DOCTRINE-SITE.md`, `draft/README.md`, `draft/SPEC-INDEX.md`, `draft/SPEC-TRACEABILITY.md`, `tools/conformance/README.md`, `specs/process/decision-log.md` (Decision 0052).\nValidation:\n- `python3 tools/conformance/generate_doctrine_site.py --check`\n- `python3 tools/conformance/check_doctrine_site.py`\n- `python3 tools/conformance/test_doctrine_site_contract.py`\n- `python3 tools/conformance/check_spec_traceability.py`\n- `python3 tools/conformance/check_docs_coherence.py`\n- `mise run ci-pipeline-test`\n- `mise run doctrine-check`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:47.886180Z","updated_at":"2026-02-22T07:21:09.203296Z","closed_at":"2026-02-22T07:21:09.203299Z","ephemeral":false,"dependencies":[{"issue_id":"bd-60","depends_on_id":"bd-56","type":"discovered-from"}]}
{"id":"bd-61","title":"[Conformance] Add boundary-authority invariance vectors across kernel/coherence/CI","description":"Introduce vectors proving invariance of authority mappings across projections: same obligation set -> same gate class mapping -> same witness lineage in proposal/coherence/ci surfaces. Includes adversarial vectors for registry mismatch and stale generated artifacts.","notes":"Completed boundary-authority invariance vectors across kernel/coherence/CI.\nDelivered:\n- Extended `tools/conformance/run_capability_vectors.py` (`capabilities.ci_witnesses`) with boundary-authority lineage validation over:\n  - kernel obligation registry (`obligationKind -> failureClass`),\n  - proposal failed-obligation discharge classes,\n  - coherence scope registry kind + bidir checker obligation coverage,\n  - CI witness semantic lineage (`semanticFailureClasses`) and union shape (`failureClasses == operational ∪ semantic`).\n- Added deterministic boundary failure classes:\n  - `boundary_authority_registry_mismatch`\n  - `boundary_authority_lineage_mismatch`\n  - `boundary_authority_stale_generated`\n- Added executable vectors:\n  - `golden/boundary_authority_lineage_accept`\n  - `adversarial/boundary_authority_registry_mismatch_reject`\n  - `adversarial/boundary_authority_stale_generated_reject`\n  - `invariance/same_boundary_authority_local`\n  - `invariance/same_boundary_authority_external`\n- Updated `capabilities.ci_witnesses` manifest and docs/spec language:\n  - `draft/CAPABILITY-VECTORS.md`\n  - `draft/CONFORMANCE.md`\n  - `tools/conformance/README.md`\n  - decision log `Decision 0053`.\nValidation:\n- `python3 tools/conformance/check_stub_invariance.py`\n- `python3 tools/conformance/run_capability_vectors.py --capability capabilities.ci_witnesses`\n- `mise run conformance-run`\n- `mise run docs-coherence-check`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:44:50.746495Z","updated_at":"2026-02-22T07:29:15.822255Z","closed_at":"2026-02-22T07:29:15.822257Z","ephemeral":false,"dependencies":[{"issue_id":"bd-61","depends_on_id":"bd-56","type":"discovered-from"},{"issue_id":"bd-61","depends_on_id":"bd-57","type":"blocks"},{"issue_id":"bd-61","depends_on_id":"bd-59","type":"blocks"},{"issue_id":"bd-61","depends_on_id":"bd-58","type":"blocks"},{"issue_id":"bd-61","depends_on_id":"bd-60","type":"blocks"},{"issue_id":"bd-61","depends_on_id":"bd-63","type":"blocks"}]}
{"id":"bd-62","title":"[Architecture] Clarify coherence vs CI: one control-plane layer, two roles (check vs execute/attest)","description":"Write explicit normative boundary: coherence-check is control-plane consistency checker; CI pipelines are execution/attestation transport over that checker surface. Define shared terminology and non-overlap with kernel semantic authority. Update PREMATH-COHERENCE, raw/PREMATH-CI, raw/CI-TOPOS, and architecture map so the relationship is explicit and machine-checkable.","notes":"Clarified control-plane boundary in docs: coherence = check role, CI = execute/attest role, kernel/gate/bidir remain semantic authority. Updated specs/premath/draft/PREMATH-COHERENCE.md (fixed authority wording in §10.1), specs/premath/raw/PREMATH-CI.md (§2.1 relation to coherence), specs/premath/raw/CI-TOPOS.md (§1.1 control-plane role), docs/design/ARCHITECTURE-MAP.md (branched control-plane path + role split), tools/ci/README.md boundary note. Verified with mise run docs-coherence-check and mise run coherence-check.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:50:10.306326Z","updated_at":"2026-02-22T05:54:08.020440Z","closed_at":"2026-02-22T05:54:08.020443Z","ephemeral":false,"dependencies":[{"issue_id":"bd-62","depends_on_id":"bd-56","type":"discovered-from"}]}
{"id":"bd-63","title":"[Control Plane] Introduce shared typed contract artifact consumed by coherence-check and CI pipelines","description":"Add one canonical machine artifact for control-plane authority surfaces (check IDs, allowed classes, witness binding keys, projection policy ids). Coherence and CI must consume this artifact instead of duplicating constants/regex-source extraction. Include deterministic generator + roundtrip tests + conformance vectors.","notes":"Completed.\nDelivered:\n- Added shared typed loader/module `tools/ci/control_plane_contract.py` as canonical importer for `draft/CONTROL-PLANE-CONTRACT.json`.\n- Migrated CI projection constants in `tools/ci/change_projection.py` to consume contract fields via shared loader.\n- Migrated required/instruction witness and policy identifiers to contract-backed constants across:\n  - `tools/ci/run_required_checks.py`\n  - `tools/ci/required_witness.py`\n  - `tools/ci/verify_decision.py`\n  - `tools/ci/run_instruction.py`\n  - `tools/ci/instruction_policy.py`\n  - `tools/ci/observation_surface.py`\n- Extended `premath-coherence` gate-chain parity to validate and expose shared witness/policy identifier fields from `controlPlaneContractPath`.\n- Updated `draft/PREMATH-COHERENCE` normative parity text to include shared control-plane witness/policy identifier shape checks.\nValidation:\n- `mise run ci-pipeline-test`\n- `mise run ci-observation-test`\n- `mise run docs-coherence-check`\n- `mise run coherence-check`\n- `mise run traceability-check`\nFollow-on scope:\n- Semantic failure lineage and cross-surface invariance vectors continue under `bd-59` and `bd-61`.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T05:50:13.498306Z","updated_at":"2026-02-22T06:12:39.999217Z","closed_at":"2026-02-22T06:12:39.999218Z","ephemeral":false,"dependencies":[{"issue_id":"bd-63","depends_on_id":"bd-56","type":"discovered-from"},{"issue_id":"bd-63","depends_on_id":"bd-62","type":"blocks"},{"issue_id":"bd-63","depends_on_id":"bd-57","type":"blocks","created_by":"codex"}]}
{"id":"bd-64","title":"[Ops] Apply and verify GitHub main ruleset policy (no bypass actors, required ci-required)","description":"Execute server-side rollout for `specs/process/GITHUB-BRANCH-POLICY.json`: configure branch/ruleset settings on GitHub main to require PR updates, require strict `ci-required` status check, disallow force-push/delete, and remove bypass actors. Configure `PREMATH_BRANCH_POLICY_TOKEN` secret for `.github/workflows/branch-policy.yml` and record first passing live run witness/log link.","notes":"Completed rollout.\nServer-side state:\n- Applied GitHub `main` protection contract via API (`PUT /repos/workingdoge/premath/branches/main/protection`) with strict `ci-required`, PR-only updates, `enforce_admins=true`, force-push/delete disabled.\n- Configured repo secret `PREMATH_BRANCH_POLICY_TOKEN`.\n- Entered bootstrap review mode (`required_approving_review_count=0`) due no reviewer pool; follow-up tracked in bd-67.\nVerification:\n- Local live checker passes (`python3 tools/ci/check_branch_policy.py --fetch-live`) using hardened fallback/admin-bypass logic from bd-65.\n- Workflow evidence:\n  - pre-fix failure: https://github.com/workingdoge/premath/actions/runs/22272316140\n  - post-fix pass (branch `codex/bd-65-branch-policy-fallback`): https://github.com/workingdoge/premath/actions/runs/22272381740\n  - latest PR-head pass (`658b72f`): https://github.com/workingdoge/premath/actions/runs/22272407035\n  - post-merge main pass (`98988bd`): https://github.com/workingdoge/premath/actions/runs/22272487569\n- PR carrying checker fix + docs/issue updates merged: https://github.com/workingdoge/premath/pull/8","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T06:39:54.087957Z","updated_at":"2026-02-22T07:06:04.999576Z","closed_at":"2026-02-22T06:57:14.691424Z","ephemeral":false,"dependencies":[{"issue_id":"bd-64","depends_on_id":"bd-55","type":"discovered-from"},{"issue_id":"bd-64","depends_on_id":"bd-65","type":"blocks","created_by":"codex"}]}
{"id":"bd-65","title":"[Governance] Tighten branch-policy checker for admin bypass + classic-protection fallback","description":"Close the policy-verification gap where live rules endpoint may be empty while classic branch protection is active, and where enforce_admins=false is not currently treated as bypass. Scope:\n- fallback from /rules/branches/{branch} to /branches/{branch}/protection when needed,\n- classify enforce_admins=false as bypass when forbidBypassActors=true,\n- add deterministic tests/fixtures for classic branch-protection payload parity.\nAcceptance:\n- checker fails on admin-bypass path,\n- checker succeeds on compliant classic protection payload,\n- live check can verify repos using either rulesets or classic branch protection.","notes":"Closed with deterministic checker hardening for minimum-encoding/maximum-expressiveness on live GitHub policy surfaces. Delivered:\n- `tools/ci/check_branch_policy.py`: live fetch now falls back from `/rules/branches/{branch}` to classic `/branches/{branch}/protection` when ruleset payload is empty.\n- Added explicit admin bypass detection from `enforce_admins` (`admin bypass path enabled: enforce_admins=false`) under `forbidBypassActors=true`.\n- Added list payload support in `_as_rule_list` for direct rules endpoint payloads.\n- Added classic branch protection golden fixture `tests/ci/fixtures/branch-policy/main-protection-golden.json`.\n- Added regression tests in `tools/ci/test_branch_policy.py` for classic protection acceptance and admin-bypass rejection.\nValidation: `python3 tools/ci/test_branch_policy.py`, `mise run ci-branch-policy-check`, and direct checker run against new fixture all pass.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T06:47:51.218723Z","updated_at":"2026-02-22T06:52:31.113327Z","closed_at":"2026-02-22T06:52:31.113330Z","ephemeral":false}
{"id":"bd-66","title":"[Ops] Document branch-protection and rollout conventions in AGENTS.md + .premath ops notes","description":"Capture operational conventions learned during governance rollout so agents follow the same path by default.\nScope:\n- update AGENTS.md with current GitHub flow constraints (protected main, PR-only updates, branch-policy workflow expectations),\n- add .premath-local ops notes artifact for routine operator actions/checklist and evidence recording,\n- link conventions to issue workflow so operational follow-ups are tracked explicitly.\nAcceptance:\n- AGENTS.md contains explicit policy-safe push/PR conventions,\n- .premath notes file documents checklist + evidence fields,\n- issue graph records the convention update and relation to bd-64.","notes":"Completed ops-conventions documentation pass.\nDelivered:\n- Updated `AGENTS.md` with explicit GitHub ops conventions: protected `main` PR-only flow, local/live branch-policy checks, `PREMATH_BRANCH_POLICY_TOKEN` requirement, and evidence-recording expectation.\n- Added tracked `.premath/OPERATIONS.md` with repeatable checklist for branch-policy rollouts plus evidence log entries.\n- Linked operational state to issue graph (bd-66 discovered-from bd-64).\nValidation: `mise run ci-hygiene-check` passed.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T06:55:39.464292Z","updated_at":"2026-02-22T06:57:30.052176Z","closed_at":"2026-02-22T06:57:30.052179Z","ephemeral":false,"dependencies":[{"issue_id":"bd-66","depends_on_id":"bd-64","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-67","title":"[Governance] Re-enable required PR approvals when reviewer pool exists","description":"Current bootstrap mode uses protected-main + required ci-required + PR-only with `required_approving_review_count=0` due no available reviewers. Track restoration to `required_approving_review_count>=1` once at least one independent reviewer is available.\nAcceptance:\n- branch policy contract and server settings updated to require >=1 approval,\n- branch-policy live workflow passes after update,\n- ops notes updated with transition evidence.","notes":"Bootstrap policy is active as of 2026-02-22:\n- `main` keeps PR-only + strict `ci-required` + `enforce_admins=true`\n- temporary `required_approving_review_count=0` due no reviewer pool\n- transition enabled merge of PR #8 and kept live branch-policy checks passing (run: https://github.com/workingdoge/premath/actions/runs/22272487569)\nNext: restore >=1 approval once at least one independent reviewer exists and re-run branch-policy live checks.","status":"open","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T07:03:09.556346Z","updated_at":"2026-02-22T07:06:05.017997Z","ephemeral":false,"dependencies":[{"issue_id":"bd-67","depends_on_id":"bd-64","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-68","title":"[Coherence/CwF] Add strict substitution + comprehension obligations and vectors","description":"Introduce a CwF-style strict presentation boundary for coherence-check: Ty/Tm substitution identity/composition plus comprehension beta/eta as deterministic obligations. Scope: spec text + contract obligation IDs + executable coherence fixtures + baseline-gated conformance integration.","notes":"Implemented CwF strictification obligations in premath-coherence: cwf_substitution_identity, cwf_substitution_composition, cwf_comprehension_beta, cwf_comprehension_eta. Updated COHERENCE-CONTRACT + PREMATH-COHERENCE spec, added coherence-site golden/adversarial fixtures, and logged Decision 0056. Validation passed: cargo test -p premath-coherence, mise run coherence-check, mise run conformance-run, mise run baseline.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T08:21:33.734088Z","updated_at":"2026-02-22T08:26:03.461835Z","closed_at":"2026-02-22T08:26:03.461837Z","ephemeral":false,"dependencies":[{"issue_id":"bd-68","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-69","title":"[Migration Follow-up] Deduplicate required_* core client transport into shared helper","description":"Reduce duplicated Python wrapper encoding in tools/ci required client modules by centralizing transport concerns (premath binary resolution, temp-input file run, stale-local-binary cargo retry, failure-class parsing). Keep payload shape validation per-client.\nAcceptance:\n- one shared helper module provides canonical command execution path,\n- required_delta/projection/witness/witness_verify/witness_decide/decision_verify/gate_ref clients use helper,\n- ci-pipeline-test passes with no behavior regressions.","notes":"Completed in one slice.\n\nDelivered:\n- Added shared transport helper `tools/ci/core_cli_client.py` for required command surfaces.\n- Migrated `required_delta_client.py`, `required_projection_client.py`, `required_witness_client.py`, `required_witness_verify_client.py`, `required_witness_decide_client.py`, `required_decision_verify_client.py`, and `required_gate_ref_client.py` to use the shared helper.\n- Kept per-client payload-shape validation local (domain-specific checks) while centralizing transport mechanics.\n\nValidation:\n- `python3 tools/ci/test_required_delta_client.py`\n- `python3 tools/ci/test_required_projection_client.py`\n- `python3 tools/ci/test_required_witness_client.py`\n- `python3 tools/ci/test_required_witness_verify_client.py`\n- `python3 tools/ci/test_required_witness_decide_client.py`\n- `python3 tools/ci/test_required_decision_verify_client.py`\n- `python3 tools/ci/test_required_gate_ref_client.py`\n- `mise run ci-pipeline-test`\n\nOutcome: behavior parity preserved while reducing duplicated wrapper encoding.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T09:41:40.001511Z","updated_at":"2026-02-22T09:45:46.223150Z","closed_at":"2026-02-22T09:45:46.223152Z","ephemeral":false,"dependencies":[{"issue_id":"bd-69","depends_on_id":"bd-34","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-7","title":"[Coherence v1] First-Class Instruction Reject Witnesses","description":"When instruction validation fails pre-execution (schema/policy/proposal binding), emit typed reject witness artifacts with deterministic failureClasses instead of only stderr/exit code.","notes":"Implemented first-class pre-execution reject witnesses. tools/ci/run_instruction.py now emits deterministic rejected ci.instruction.v1 artifacts with rejectStage=pre_execution and typed failureClasses on envelope/policy/proposal validation failures. tools/ci/pipeline_instruction.py now guarantees witness emission even when envelope check fails. Added tests in tools/ci/test_instruction_reject_witness.py, added ci-pipeline-test coverage, and extended ci_witnesses capability vectors with reject-witness determinism/mismatch cases.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-21T23:06:54.527190Z","updated_at":"2026-02-21T23:40:55.846448Z","closed_at":"2026-02-21T23:40:55.846452Z","ephemeral":false,"dependencies":[{"issue_id":"bd-7","depends_on_id":"bd-6","type":"blocks"},{"issue_id":"bd-7","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-70","title":"[Migration Follow-up] Move proposal-check Python transport onto shared core_cli_client","description":"Adopt tools/ci/core_cli_client.py in proposal_check_client.py to remove duplicate command transport code (binary resolution, stale-local retry, failure extraction, JSON decode/retry) while keeping proposal payload-shape validation local.\nAcceptance:\n- proposal_check_client uses shared helper,\n- proposal client tests pass,\n- ci-pipeline-test remains green.","notes":"Completed in one slice.\n\nDelivered:\n- Refactored `tools/ci/proposal_check_client.py` to use shared `tools/ci/core_cli_client.py` transport path.\n- Preserved proposal-specific failure-class behavior for payload-shape mismatches via deterministic mapping in client layer.\n\nValidation:\n- `python3 tools/ci/test_proposal_check_client.py`\n- `mise run ci-pipeline-test`\n\nOutcome: proposal-check wrapper now follows the same minimum-encoding transport surface as required clients.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T09:46:51.426649Z","updated_at":"2026-02-22T09:48:24.624369Z","closed_at":"2026-02-22T09:48:24.624371Z","ephemeral":false,"dependencies":[{"issue_id":"bd-70","depends_on_id":"bd-34","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-71","title":"[Migration Follow-up] Route instruction check/witness clients through shared core_cli_client transport","description":"Reduce duplicated wrapper transport in tools/ci/instruction_check_client.py by using core_cli_client helpers for both instruction-check and instruction-witness command paths while preserving existing failure-class semantics.\nAcceptance:\n- instruction-check uses shared path-input transport,\n- instruction-witness uses shared payload-input transport with optional pre-execution flags,\n- instruction client tests + ci-pipeline-test pass.","notes":"Completed in one slice.\n\nDelivered:\n- Refactored `tools/ci/instruction_check_client.py` to use shared `tools/ci/core_cli_client.py` transport for both instruction-check and instruction-witness flows.\n- Added shared helper support for path-input commands (`run_core_json_command_from_path`) and optional extra args, and explicit invalid-json failure-class override support.\n- Preserved instruction-specific failure classes and pre-execution witness argument semantics.\n\nValidation:\n- `python3 tools/ci/test_instruction_check_client.py`\n- `mise run ci-pipeline-test`\n\nOutcome: instruction client wrappers now align with minimum-encoding transport architecture used by required/proposal clients.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T09:51:52.112256Z","updated_at":"2026-02-22T09:52:04.164266Z","closed_at":"2026-02-22T09:52:04.164268Z","ephemeral":false,"dependencies":[{"issue_id":"bd-71","depends_on_id":"bd-34","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-72","title":"[bd-33] Enforce client-transport parity for CI command wrappers","description":"Add deterministic parity test ensuring CI command wrapper clients use shared `tools/ci/core_cli_client.py` transport surface and do not reintroduce duplicate transport loops.\nAcceptance:\n- parity test covers required/proposal/instruction client modules,\n- test is wired into `mise run ci-pipeline-test`,\n- documented in issue notes with validation evidence.","notes":"Completed in one slice.\n\nDelivered:\n- Added `tools/ci/test_client_transport_parity.py` to enforce wrapper transport parity over CI command clients.\n- Test asserts shared helper import/usage (`core_cli_client`) and bans legacy local transport patterns.\n- Wired test into `.mise.toml` under `ci-pipeline-test`.\n\nValidation:\n- `python3 tools/ci/test_client_transport_parity.py`\n- `mise run ci-pipeline-test`\n\nOutcome: wrapper command-surface parity now has deterministic executable enforcement, reducing risk of semantic drift back into Python wrappers.","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T09:53:32.048533Z","updated_at":"2026-02-22T09:54:11.036074Z","closed_at":"2026-02-22T09:54:11.036075Z","ephemeral":false,"dependencies":[{"issue_id":"bd-72","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-72","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-73","title":"[bd-33] Enforce PREMATH-COHERENCE obligation-set parity in scope checker","description":"Add executable parity invariant in `scope_noncontradiction` requiring `PREMATH-COHERENCE` §3 obligation IDs to stay aligned with checker required obligation IDs.\nAcceptance:\n- coherence contract surfaces bind PREMATH-COHERENCE section bounds,\n- checker emits deterministic failures for missing/unknown obligation IDs in the spec list,\n- unit test + pipeline tests pass.","notes":"Completed in one slice.\n\nDelivered:\n- Extended `scope_noncontradiction` to parse `PREMATH-COHERENCE` §3 and enforce parity with executable required coherence obligations.\n- Added deterministic failure classes:\n  - `coherence.scope_noncontradiction.coherence_spec_missing_obligation`\n  - `coherence.scope_noncontradiction.coherence_spec_unknown_obligation`\n- Added contract surface bindings:\n  - `coherenceSpecPath`\n  - `coherenceSpecObligationStart`\n  - `coherenceSpecObligationEnd`\n- Added unit test `validate_required_obligation_parity_reports_missing_and_unknown`.\n- Updated `PREMATH-COHERENCE` normative text and recorded Decision 0068.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run ci-pipeline-test`\n- `mise run coherence-check`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T09:59:02.906074Z","updated_at":"2026-02-22T09:59:15.697323Z","closed_at":"2026-02-22T09:59:15.697326Z","ephemeral":false,"dependencies":[{"issue_id":"bd-73","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-73","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-74","title":"[bd-33] Add CLI smoke for PREMATH obligation drift rejection","description":"Add an end-to-end premath-cli smoke test that mutates PREMATH-COHERENCE §3 obligation IDs via a temp coherence contract binding and asserts `coherence-check` rejects with deterministic scope failure classes.\nAcceptance:\n- test drives CLI `coherence-check --json`,\n- asserts rejected result + expected failure classes,\n- included in existing cli_smoke suite and passes with baseline pipeline.","notes":"Completed in one slice.\n\nDelivered:\n- Added end-to-end CLI smoke `coherence_check_rejects_on_coherence_spec_obligation_drift` in `crates/premath-cli/tests/cli_smoke.rs`.\n- Test mutates `PREMATH-COHERENCE` obligation list through a temp contract binding (`coherenceSpecPath`) and runs canonical command surface `premath coherence-check --json`.\n- Asserts rejected witness and deterministic failure classes:\n  - `coherence.scope_noncontradiction.coherence_spec_missing_obligation`\n  - `coherence.scope_noncontradiction.coherence_spec_unknown_obligation`\n- Recorded Decision 0069.\n\nValidation:\n- `cargo test -p premath-cli --test cli_smoke coherence_check_rejects_on_coherence_spec_obligation_drift`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:01:16.373090Z","updated_at":"2026-02-22T10:02:14.935034Z","closed_at":"2026-02-22T10:02:14.935035Z","ephemeral":false,"dependencies":[{"issue_id":"bd-74","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-74","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-75","title":"[bd-33] Make coherence-contract cache inputs closed over contract surfaces","description":"Fix conformance cache validity for `coherence-contract` suite by deriving cache input paths from `COHERENCE-CONTRACT.json` surface/operation path declarations, so cache hits cannot skip runs when checker-read docs/surfaces change.\nAcceptance:\n- `run_fixture_suites.py` coherence-contract suite input closure includes contract-declared paths,\n- deterministic unit test verifies inclusion of key paths (`coherenceSpecPath`, `specIndexPath`, capability manifest root, expected operation path),\n- `ci-pipeline-test` runs new test.","notes":"Completed in one slice.\n\nDelivered:\n- Updated `tools/conformance/run_fixture_suites.py` so `coherence-contract` suite cache inputs are derived from `COHERENCE-CONTRACT.json` declarations:\n  - include `surfaces.*Path` and `surfaces.*Root`,\n  - include top-level `expectedOperationPaths[]`,\n  - retain deterministic fallback baseline paths if contract parse fails.\n- Added `tools/conformance/test_run_fixture_suites.py` verifying closure includes key checker-read surfaces and remains duplicate-free.\n- Wired new test into `.mise.toml` `ci-pipeline-test`.\n- Recorded Decision 0070.\n\nValidation:\n- `python3 tools/conformance/test_run_fixture_suites.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:03:53.220799Z","updated_at":"2026-02-22T10:04:30.750870Z","closed_at":"2026-02-22T10:04:30.750873Z","ephemeral":false,"dependencies":[{"issue_id":"bd-75","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-75","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-76","title":"[bd-33] Prove coherence-contract cache ref drifts on coherence spec edits","description":"Add deterministic test showing `coherence-contract` suite cache material/cache refs change when `PREMATH-COHERENCE` content changes (without changing params hash), using suite-plan construction.\nAcceptance:\n- test uses actual coherence-contract input closure,\n- test asserts cache/material drift on coherence-spec content mutation,\n- wired through existing `ci-pipeline-test` run.","notes":"Completed in one slice.\n\nDelivered:\n- Extended `tools/conformance/test_run_fixture_suites.py` with drift proof `test_coherence_contract_cache_ref_changes_when_coherence_spec_changes`.\n- Test uses actual `coherence-contract` suite closure, mutates only `PREMATH-COHERENCE` input via temporary file substitution, and asserts:\n  - `params_hash` unchanged,\n  - `material_digest` changed,\n  - `cache_ref` changed.\n- Recorded Decision 0071.\n\nValidation:\n- `python3 tools/conformance/test_run_fixture_suites.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:05:44.517127Z","updated_at":"2026-02-22T10:06:20.660860Z","closed_at":"2026-02-22T10:06:20.660863Z","ephemeral":false,"dependencies":[{"issue_id":"bd-76","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-76","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-77","title":"[bd-33] Include overlayDocs-derived files in coherence-contract cache closure","description":"Close cache parity gap by adding `overlayDocs`-derived markdown file paths (e.g. `specs/premath/<overlay>.md`) to `coherence-contract` suite cache inputs, because coherence-check reads these paths in `overlay_traceability`.\nAcceptance:\n- loader includes overlay file paths from contract `overlayDocs`,\n- unit test asserts overlay path inclusion,\n- pipeline tests remain green.","notes":"Completed in one slice.\n\nDelivered:\n- Extended `tools/conformance/run_fixture_suites.py::load_coherence_contract_input_paths()` to include overlay docs derived from `COHERENCE-CONTRACT.json` `overlayDocs` entries (`specs/premath/{overlay}.md`).\n- Added/updated unit coverage in `tools/conformance/test_run_fixture_suites.py` to assert inclusion of `specs/premath/profile/ADJOINTS-AND-SITES.md`.\n- Recorded Decision 0072.\n\nValidation:\n- `python3 tools/conformance/test_run_fixture_suites.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:07:10.695042Z","updated_at":"2026-02-22T10:07:39.948697Z","closed_at":"2026-02-22T10:07:39.948700Z","ephemeral":false,"dependencies":[{"issue_id":"bd-77","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-77","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-78","title":"[bd-33] Include premath-kernel authority source in coherence-contract cache closure","description":"Close cache parity gap by including `crates/premath-kernel/src` in `coherence-contract` suite cache inputs, since coherence-check reads kernel obligation registry authority via `premath-kernel`.\nAcceptance:\n- cache input loader includes premath-kernel source path,\n- unit test asserts path inclusion,\n- pipeline tests pass.","notes":"Completed in one slice.\n\nDelivered:\n- Added `crates/premath-kernel/src` to `coherence-contract` cache input closure in `tools/conformance/run_fixture_suites.py`.\n- Updated `tools/conformance/test_run_fixture_suites.py` to assert kernel source inclusion.\n- Recorded Decision 0073.\n\nValidation:\n- `python3 tools/conformance/test_run_fixture_suites.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:08:18.913545Z","updated_at":"2026-02-22T10:08:46.777011Z","closed_at":"2026-02-22T10:08:46.777013Z","ephemeral":false,"dependencies":[{"issue_id":"bd-78","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-78","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-79","title":"[bd-33] Include Cargo manifest surfaces in coherence-contract cache closure","description":"Add `Cargo.toml` and `Cargo.lock` to coherence-contract cache inputs so dependency/feature changes affecting coherence-check invalidate cache refs.\nAcceptance:\n- cache input loader includes repo Cargo manifests,\n- unit test asserts inclusion,\n- ci-pipeline-test remains green.","notes":"Completed in one slice.\n\nDelivered:\n- Added `Cargo.toml` and `Cargo.lock` to `coherence-contract` cache input closure in `tools/conformance/run_fixture_suites.py`.\n- Updated `tools/conformance/test_run_fixture_suites.py` to assert both manifest paths are included.\n- Recorded Decision 0074.\n\nValidation:\n- `python3 tools/conformance/test_run_fixture_suites.py`\n- `mise run ci-pipeline-test`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:10:22.474886Z","updated_at":"2026-02-22T10:10:50.286748Z","closed_at":"2026-02-22T10:10:50.286751Z","ephemeral":false,"dependencies":[{"issue_id":"bd-79","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-79","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-8","title":"[Coherence v1] Capability-Gated Issue Mutation Policy","description":"Bind issue/dep mutation permission to instruction witness capabilities (not only instruction presence). Enforce per-action capability claims and policy scoping for issue_add/update/claim/discover/dep_add.","notes":"Implemented capability-gated instruction-linked mutation policy. MCP issue/dep mutations now require accepted instruction witness with allowed policyDigest scope and capabilityClaims containing base capabilities.change_morphisms plus per-action claim (or capabilities.change_morphisms.all). Added Rust unit tests for unscoped policy reject, missing action claim reject, and dep_add action claim enforcement. Instruction envelopes/witnesses now support optional capabilityClaims; checker validates list shape and runner emits claims into witness.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-21T23:06:58.248792Z","updated_at":"2026-02-21T23:50:37.219793Z","closed_at":"2026-02-21T23:50:37.219795Z","ephemeral":false,"dependencies":[{"issue_id":"bd-8","depends_on_id":"bd-5","type":"blocks"},{"issue_id":"bd-8","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-80","title":"[bd-28] Add span/square schema + coherence checker hook for pipeline/base-change commutation","description":"Introduce minimum-encoding span/square layer for pipeline transport semantics.\nScope:\n- draft spec for `SpanRef` and `SquareWitness` shapes + commutation contract,\n- machine fixture surface for initial witness set,\n- coherence-check hook validating typed shape and basic square consistency (accepted=>no failure classes, rejected=>failure classes present).\nAcceptance:\n- spec document added and linked from index,\n- coherence checker reads configured span/square witness path and emits deterministic failure classes on invalid artifacts,\n- tests + pipeline green.","notes":"Completed in one slice.\n\nDelivered:\n- Added new required coherence obligation `span_square_commutation` with checker hook in `premath-coherence`.\n- Added typed evaluator `evaluate_site_case_span_square_commutation` enforcing:\n  - span/square typed shape,\n  - square digest determinism (`sqw1_`),\n  - accepted square contract (no failures + top/bottom commutation),\n  - rejected square contract (non-empty failure classes).\n- Added coherence-site executable vectors:\n  - `golden/span_square_commutation_accept`\n  - `adversarial/span_square_commutation_reject`\n- Added new draft spec `specs/premath/draft/SPAN-SQUARE-CHECKING.md`.\n- Glued spec/docs scope updates:\n  - `SPEC-INDEX.md` informative list,\n  - `draft/README.md` start-here list,\n  - `UNIFICATION-DOCTRINE.md` relationship section,\n  - `SPEC-TRACEABILITY.md` matrix row.\n- Updated coherence normative surfaces:\n  - `PREMATH-COHERENCE.md` obligation set + semantics,\n  - `COHERENCE-CONTRACT.json` obligation registry.\n- Recorded Decision 0075.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/check_spec_traceability.py`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:13:45.422293Z","updated_at":"2026-02-22T10:19:12.603914Z","closed_at":"2026-02-22T10:19:12.603916Z","ephemeral":false,"dependencies":[{"issue_id":"bd-80","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-80","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-81","title":"[bd-33] Extend span/square vectors with invariance + digest-mismatch adversarial cases","description":"Tighten span/square checker coverage with one invariance vector (permuted span ordering) and one adversarial digest mismatch vector.\nAcceptance:\n- coherence-site manifest includes new vectors for `span_square_commutation`,\n- coherence-check accepts invariance case and rejects digest mismatch case deterministically,\n- pipeline tests and coherence-check pass.","notes":"Added span/square invariance + digest-mismatch adversarial vectors and wired into coherence-site manifest. Validation: mise run coherence-check; python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache; mise run ci-pipeline-test; cargo run --package premath-cli -- coherence-check --contract specs/premath/draft/COHERENCE-CONTRACT.json --repo-root . --json (verified span_square_commutation vector matching).","status":"closed","priority":1,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:20:33.313265Z","updated_at":"2026-02-22T10:22:33.007268Z","closed_at":"2026-02-22T10:22:33.007272Z","ephemeral":false,"dependencies":[{"issue_id":"bd-81","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-81","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-82","title":"[bd-33] Enforce coherence-site obligation polarity coverage (golden + adversarial)","description":"Tighten site fixture contract so each coherence-site obligation has both acceptance and rejection vectors.\nAcceptance:\n- coherence checker fails when an obligation has no matched golden vectors,\n- coherence checker fails when an obligation has no matched adversarial vectors,\n- unit tests cover both failure modes and one passing mixed case.","notes":"Implemented coherence-site polarity enforcement in checker: each matched obligation now requires at least one `golden/` and at least one `adversarial/` vector. Added deterministic failure classes `coherence.<obligation_id>.missing_golden_vector` and `.missing_adversarial_vector`, plus matched-vector kind counters in witness details. Added Rust unit tests for missing-golden, missing-adversarial, and both-present passing cases. Updated PREMATH-COHERENCE spec with Site Vector Polarity Coverage clause and recorded Decision 0077. Validation: cargo test -p premath-coherence; mise run coherence-check; python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache; mise run ci-pipeline-test; python3 tools/conformance/check_spec_traceability.py.","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:23:46.060043Z","updated_at":"2026-02-22T10:26:52.780375Z","closed_at":"2026-02-22T10:26:52.780378Z","ephemeral":false,"dependencies":[{"issue_id":"bd-82","depends_on_id":"bd-33","type":"discovered-from","created_by":"codex"},{"issue_id":"bd-82","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-83","title":"[bd-28] Isolate coherence-site obligation input scope to reduce cross-obligation blast radius","description":"Current coherence-site obligations share one manifest. A malformed unrelated vector can fail multiple obligations.\nAcceptance:\n- define and implement obligation-scoped fixture loading or equivalent isolation contract,\n- preserve deterministic witness output,\n- add regression test proving unrelated malformed vectors do not fail untouched obligations.","notes":"Implemented obligation-scoped coherence-site vector loading to eliminate cross-obligation blast radius.\n\nDelivered:\n- Extended `coherence-site` manifest schema with `obligationVectors` map (obligation id -> vector ids).\n- Updated `check_site_obligation` to parse/evaluate only mapped vectors for the active obligation.\n- Added deterministic scope failures for missing/inconsistent mapping:\n  - `coherence.<obligation_id>.manifest_missing_obligation_vectors`\n  - `coherence.<obligation_id>.manifest_obligation_vector_not_declared`\n  - `coherence.<obligation_id>.manifest_obligation_vector_mismatch`\n- Added checker details surface: `manifestObligationVectors` + `scopedVectors`.\n- Updated repository fixture manifest with full obligation-to-vector map.\n- Added regression test `check_site_obligation_ignores_unscoped_malformed_vectors` proving malformed unscoped vectors do not fail unrelated obligations.\n- Updated PREMATH-COHERENCE site vector clause and recorded Decision 0079.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/check_spec_traceability.py`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:31:08.973232Z","updated_at":"2026-02-22T10:36:01.782415Z","closed_at":"2026-02-22T10:36:01.782417Z","ephemeral":false,"dependencies":[{"issue_id":"bd-83","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-84","title":"[bd-28] Enforce semantic polarity coverage for coherence-site obligations","description":"Prefix polarity (`golden/`/`adversarial/`) is insufficient alone. Require semantic polarity from expect payloads.\nAcceptance:\n- checker requires at least one matched expectedResult=accepted vector and one matched expectedResult=rejected vector per site obligation,\n- deterministic failure classes emitted when missing,\n- unit tests cover missing-accept, missing-reject, and passing mixed case.","notes":"Implemented semantic polarity enforcement for coherence-site obligations in `check_site_obligation`.\n\nDelivered:\n- Added semantic result counters from `expect.result` (`accepted`/`rejected`) for matched vectors.\n- Added deterministic failures when missing:\n  - `coherence.<obligation_id>.missing_expected_accepted_vector`\n  - `coherence.<obligation_id>.missing_expected_rejected_vector`\n- Added witness details surface `matchedExpectedResults` with accepted/rejected counts.\n- Extended Rust tests:\n  - missing expected-accept vector,\n  - missing expected-reject vector,\n  - passing mixed semantic polarity case.\n- Updated draft spec clause (`PREMATH-COHERENCE` §4.15) and recorded Decision 0078.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/check_spec_traceability.py`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:31:08.984224Z","updated_at":"2026-02-22T10:33:09.020566Z","closed_at":"2026-02-22T10:33:09.020567Z","ephemeral":false,"dependencies":[{"issue_id":"bd-84","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-85","title":"[bd-28] Add invariance-pair contract enforcement for coherence-site fixtures","description":"coherence-site currently does not enforce invariance pair structure like capability fixtures.\nAcceptance:\n- checker enforces invariance scenario pairing contract for site vectors,\n- invariance pairing failures are deterministic,\n- regression tests cover missing pair and mismatched pair.","notes":"Implemented invariance-pair contract enforcement for `coherence-site` obligations in `premath-coherence`.\n\nDelivered:\n- Added `invariance/` contract checks in `check_site_obligation`:\n  - require non-empty `semanticScenarioId` and `profile` in case payloads,\n  - group invariance vectors by `semanticScenarioId`,\n  - require exactly two rows per scenario,\n  - require distinct profiles,\n  - require matched `actualResult` and `actualFailureClasses` across pair.\n- Added deterministic failures:\n  - `coherence.<obligation_id>.invariance_missing_semantic_scenario`\n  - `coherence.<obligation_id>.invariance_missing_profile`\n  - `coherence.<obligation_id>.invariance_pair_count_mismatch`\n  - `coherence.<obligation_id>.invariance_profile_not_distinct`\n  - `coherence.<obligation_id>.invariance_result_mismatch`\n  - `coherence.<obligation_id>.invariance_failure_class_mismatch`\n- Extended unit tests:\n  - pair-count mismatch,\n  - pair-result mismatch,\n  - passing local/external invariance pair.\n- Updated coherence-site fixtures:\n  - added `semanticScenarioId` + `profile` to existing invariance cases,\n  - added external-profile pair vectors for glue-or-witness and span-square invariance scenarios,\n  - updated manifest vector scopes.\n- Updated `PREMATH-COHERENCE` §4.15 and recorded Decision 0080.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/check_spec_traceability.py`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:31:08.992004Z","updated_at":"2026-02-22T10:40:43.649947Z","closed_at":"2026-02-22T10:40:43.649949Z","ephemeral":false,"dependencies":[{"issue_id":"bd-85","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-86","title":"[bd-28] Harmonize invariance-pair contract across coherence fixture families","description":"`coherence-site` now enforces invariance pairs by semantic scenario/profile, but `coherence-transport` still treats invariance as single-vector coverage.\nAcceptance:\n- define one invariance contract shape for both fixture families (site + transport) or document a principled exception,\n- enforce deterministic checker behavior for the chosen shape,\n- add/update fixtures and tests so conformance vectors prove the contract.","notes":"Harmonized invariance-pair contract across coherence fixture families by extending transport checker semantics to match site invariance rules.\n\nDelivered:\n- Added shared invariance helpers in `premath-coherence` used by both site and transport checker paths.\n- Extended `check_transport_functoriality` to enforce `invariance/` pair contract:\n  - require non-empty `semanticScenarioId` and `profile`,\n  - group by `semanticScenarioId`,\n  - require exactly two rows with distinct profiles,\n  - require same evaluated result and failure-class set.\n- Added deterministic transport failures aligned with site semantics:\n  - `coherence.transport_functoriality.invariance_missing_semantic_scenario`\n  - `coherence.transport_functoriality.invariance_missing_profile`\n  - `coherence.transport_functoriality.invariance_pair_count_mismatch`\n  - `coherence.transport_functoriality.invariance_profile_not_distinct`\n  - `coherence.transport_functoriality.invariance_result_mismatch`\n  - `coherence.transport_functoriality.invariance_failure_class_mismatch`\n- Added transport unit tests:\n  - missing pair count,\n  - pair result mismatch,\n  - passing local/external invariance pair.\n- Updated coherence-transport fixtures:\n  - annotated existing invariance case with `profile=local`,\n  - added external pair vector `invariance/permuted_payload_accept_external`,\n  - updated manifest vectors.\n- Updated PREMATH-COHERENCE §4.15 to define invariance-pair contract across both fixture families; recorded Decision 0081.\n\nValidation:\n- `cargo test -p premath-coherence`\n- `mise run coherence-check`\n- `python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache`\n- `mise run ci-pipeline-test`\n- `python3 tools/conformance/check_spec_traceability.py`\n- `mise run ci-required-attested`","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:42:13.925451Z","updated_at":"2026-02-22T10:48:36.067062Z","closed_at":"2026-02-22T10:48:36.067066Z","ephemeral":false,"dependencies":[{"issue_id":"bd-86","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-87","title":"[bd-28] Enforce transport vector polarity coverage parity with site fixtures","description":"`coherence-site` enforces path + semantic polarity (golden/adversarial and accepted/rejected), but `coherence-transport` does not yet enforce equivalent polarity constraints.\nAcceptance:\n- `check_transport_functoriality` rejects when golden/adversarial path polarity is missing,\n- rejects when expected result polarity (accepted/rejected) is missing,\n- deterministic failure classes and unit tests for missing-golden, missing-adversarial, missing-accepted, missing-rejected, and passing mixed case,\n- PREMATH-COHERENCE and decision log updated.","notes":"Completed transport polarity parity in premath-coherence.\n- Extended `check_transport_functoriality` to enforce golden/adversarial presence and accepted/rejected expected-result coverage, with deterministic failure classes.\n- Added witness detail counters (`matchedVectorKinds`, `matchedExpectedResults`) for transport vectors.\n- Added transport parity unit tests for golden/adversarial and accepted/rejected polarity constraints.\n- Updated PREMATH-COHERENCE draft spec and decision log (Decision 0082).\nValidation run:\n- cargo fmt --all\n- cargo test -p premath-coherence\n- mise run coherence-check\n- python3 tools/conformance/run_fixture_suites.py --suite coherence-contract --no-cache\n- mise run ci-pipeline-test\n- python3 tools/conformance/check_spec_traceability.py\n- mise run ci-required-attested","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:49:19.214394Z","updated_at":"2026-02-22T10:52:39.494540Z","closed_at":"2026-02-22T10:52:39.494543Z","ephemeral":false,"dependencies":[{"issue_id":"bd-87","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-88","title":"[bd-28] Factor shared polarity coverage accounting across coherence-site and transport","description":"Both `check_site_obligation` and `check_transport_functoriality` implement near-identical counting/checking for vector-kind polarity (`golden`/`adversarial`/`invariance`) and expected-result polarity (`accepted`/`rejected`).\n\nAcceptance:\n- introduce one shared helper for polarity accounting + deterministic missing-polarity failure emission,\n- preserve existing failure class strings and witness detail fields (`matchedVectorKinds`, `matchedExpectedResults`),\n- keep existing transport/site polarity tests passing with no fixture/schema changes.","notes":"Completed shared polarity accounting extraction in `premath-coherence`.\n\nDelivered:\n- added `PolarityCoverage` helper with shared methods:\n  - `record_vector_id`\n  - `record_expected_result`\n  - `emit_missing_failures`\n  - detail render helpers for `matchedVectorKinds` and `matchedExpectedResults`\n- replaced duplicate site/transport polarity counting and missing-polarity failure emission with the shared helper.\n- preserved existing failure class strings and witness detail field names.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-coherence\n- mise run coherence-check","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:53:30.379424Z","updated_at":"2026-02-22T10:54:44.135156Z","closed_at":"2026-02-22T10:54:44.135159Z","ephemeral":false,"dependencies":[{"issue_id":"bd-88","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-89","title":"[bd-28] Add deterministic issue backend-status surface (jsonl/surreal/jj)","description":"Add a first-class issue command that reports current backend integration state for work memory:\n- canonical JSONL authority path/existence,\n- surreal projection path/existence,\n- JJ availability + workspace/root/head metadata when available.\n\nAcceptance:\n- new CLI command `premath issue backend-status` (JSON + text modes),\n- deterministic JSON payload shape suitable for MCP/automation,\n- command does not fail when JJ is unavailable (returns explicit availability/error state),\n- CLI smoke test coverage.","notes":"Implemented deterministic backend integration status surface for issue memory.\n\nDelivered:\n- added new CLI subcommand: `premath issue backend-status`\n  - args: `--issues`, `--repo`, `--projection`, `--json`\n- JSON payload reports:\n  - canonical JSONL authority path/existence,\n  - surreal projection cache path/existence (`premath.surreal.issue_projection.v0`),\n  - JJ integration state (`ready|error|unavailable`) with availability, discovered repo root, head change id, and error message (when present).\n- command is fail-soft for JJ: reports explicit unavailable/error state without failing command execution.\n- added CLI smoke coverage: `issue_backend_status_json_smoke`.\n- updated command docs in `README.md` and `AGENTS.md`.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli\n- cargo run --package premath-cli -- issue backend-status --issues .premath/issues.jsonl --repo . --projection .premath/surreal_issue_cache.json --json","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T10:56:57.636471Z","updated_at":"2026-02-22T10:58:48.990987Z","closed_at":"2026-02-22T10:58:48.990988Z","ephemeral":false,"dependencies":[{"issue_id":"bd-89","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-9","title":"[Coherence v1] Multiagent Claim/Lease Protocol","description":"Add deterministic claim leases for ready issues (owner, lease_id, expiry, renew/release) to reduce multiagent collision and implicit work stealing. Include failure classes and observation projections for stale/contended leases.","notes":"Implemented deterministic multiagent claim-lease protocol in premath runtime: added first-class Issue lease state (lease_id, owner, acquired_at, expires_at, renewed_at), lease-aware issue_claim with deterministic failure classes, new MCP mutations issue_lease_renew and issue_lease_release, and read model issue_lease_projection for stale/contended leases. Mutation policy gating extended with per-action capability claims for lease renew/release. Added Rust unit tests for claim/renew/release/projection behavior and stale renew rejection. Extended capabilities.change_morphisms executable vectors with lease claim/lease projection golden/adversarial cases. Updated CAPABILITY-VECTORS, CONFORMANCE, README, ARCHITECTURE-MAP, and decision log (Decision 0019).","status":"closed","priority":2,"issue_type":"task","created_at":"2026-02-21T23:07:01.386807Z","updated_at":"2026-02-22T00:03:33.408910Z","closed_at":"2026-02-22T00:03:33.408912Z","ephemeral":false,"dependencies":[{"issue_id":"bd-9","depends_on_id":"bd-8","type":"blocks"},{"issue_id":"bd-9","depends_on_id":"bd-4","type":"discovered-from"}]}
{"id":"bd-90","title":"[bd-28] Expose issue backend-status as MCP read tool","description":"Expose backend integration state through MCP so agents can query authority/projection/VCS posture without shelling out.\n\nAcceptance:\n- add read-only MCP tool `issue_backend_status`,\n- output includes canonical memory (jsonl) path/existence, surreal projection path/existence, configured query backend, and JJ state (`ready|error|unavailable`) with metadata,\n- deterministic JSON payload shape,\n- unit test coverage in `mcp_serve` tests,\n- README MCP tool list updated.","notes":"Implemented MCP read tool `issue_backend_status`.\n\nDelivered:\n- added new MCP tool: `issue_backend_status` (read-only),\n- payload reports deterministic integration state:\n  - canonical JSONL authority path/existence,\n  - surreal issue projection path/existence,\n  - configured query backend,\n  - JJ state (`ready|error|unavailable`) with availability, discovered repo root, head change id, and error when present,\n- wired tool into MCP dispatch and registry (`tool_box`),\n- updated server guidance text to mention `issue_backend_status`,\n- added unit test: `issue_backend_status_reports_integration_state`,\n- updated README MCP data-plane tool list.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:01:04.304109Z","updated_at":"2026-02-22T11:02:26.618849Z","closed_at":"2026-02-22T11:02:26.618852Z","ephemeral":false,"dependencies":[{"issue_id":"bd-90","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-91","title":"[bd-28] Unify backend-status evaluation across CLI and MCP","description":"`premath issue backend-status` and MCP `issue_backend_status` currently duplicate integration-state logic.\n\nAcceptance:\n- extract one shared helper in `crates/premath-cli/src/support.rs` for backend-status evaluation,\n- route both CLI and MCP surfaces through that helper,\n- preserve existing payload shapes and failure behavior,\n- keep tests green for both surfaces.","notes":"Unified backend-status evaluation across CLI and MCP surfaces.\n\nDelivered:\n- added shared helper in `crates/premath-cli/src/support.rs`:\n  - `collect_backend_status(...)`\n  - `BackendStatus` shared struct\n  - shared constant `ISSUE_QUERY_PROJECTION_KIND`\n- refactored CLI `issue backend-status` implementation (`commands/issue.rs`) to use shared helper.\n- refactored MCP `issue_backend_status` implementation (`commands/mcp_serve.rs`) to use shared helper.\n- removed duplicated per-surface JJ/projection/status logic while preserving payload shape.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:03:25.852855Z","updated_at":"2026-02-22T11:04:31.496027Z","closed_at":"2026-02-22T11:04:31.496030Z","ephemeral":false,"dependencies":[{"issue_id":"bd-91","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-92","title":"[bd-28] Unify backend-status payload rendering across CLI and MCP","description":"Backend-status state collection is shared, but JSON payload rendering is still duplicated between CLI and MCP paths.\n\nAcceptance:\n- add one shared payload builder for backend-status in `support.rs`,\n- route both CLI issue command and MCP tool through it,\n- preserve existing payload semantics and deterministic field set,\n- keep cli + mcp tests green.","notes":"Unified backend-status payload rendering across CLI and MCP.\n\nDelivered:\n- added shared payload builder in `support.rs`: `backend_status_payload(action, status, query_backend)`.\n- routed CLI `issue backend-status` JSON mode through shared payload builder.\n- routed MCP `issue_backend_status` tool through shared payload builder.\n- preserved payload semantics while reducing duplicated encoding logic.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:05:52.663185Z","updated_at":"2026-02-22T11:07:00.375577Z","closed_at":"2026-02-22T11:07:00.375580Z","ephemeral":false,"dependencies":[{"issue_id":"bd-92","depends_on_id":"bd-28","type":"discovered-from"}]}
{"id":"bd-93","title":"[bd-28] Bind issue projection provenance to authority snapshot refs","description":"Current issue backend-status reports projection presence only. Add deterministic provenance so projection freshness can be evaluated against canonical JSONL authority with minimal extra encoding.\n\nAcceptance:\n- issue query projection payload carries optional `sourceSnapshotRef` bound to `store_snapshot_ref`.\n- backend-status surfaces authority/projection snapshot refs and deterministic projection freshness state (`fresh|stale|invalid|missing|unknown`).\n- MCP and CLI backend-status share the same payload surface.\n- projection loader remains backward-compatible with existing projection files.\n- tests cover fresh and stale/invalid projection status paths.","notes":"Implemented projection provenance/freshness binding across issue backend surfaces.\n\nDelivered:\n- Added optional `sourceSnapshotRef` to issue query projection payloads written by MCP (`IssueQueryProjection`) bound to `store_snapshot_ref`.\n- Extended shared backend status model/payload with deterministic authority+projection provenance:\n  - `canonicalMemory.snapshotRef` + `canonicalMemory.error`\n  - `queryProjection.state` (`fresh|stale|invalid|missing|unknown`)\n  - projection metadata (`schema`, `projectionKind`, `sourceIssuesPath`, `sourceSnapshotRef`) and match booleans (`sourcePathMatchesAuthority`, `snapshotRefMatchesAuthority`) plus `queryProjection.error`.\n- Kept projection load backward-compatible via optional projection snapshot field.\n- Added MCP tests for fresh and stale projection states.\n- Updated CLI smoke to assert deterministic invalid-state behavior for malformed projection payload (`{}`).\n- Updated command docs in README + AGENTS.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli\n- mise run baseline","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:10:41.223236Z","updated_at":"2026-02-22T11:13:11.355798Z","closed_at":"2026-02-22T11:13:11.355800Z","ephemeral":false,"dependencies":[{"issue_id":"bd-93","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-94","title":"[bd-28] Enforce projection source-path parity on surreal query loads","description":"Surreal projection reads currently accept any projection payload with matching schema/kind when mtime appears fresh. Add deterministic source-path parity so a projection built from a different authority file path is never served as current.\n\nAcceptance:\n- projection load path validates `sourceIssuesPath` against requested authority issues path,\n- mismatch triggers projection refresh from canonical authority store before serving reads,\n- behavior remains backward-compatible for legacy projection payloads,\n- unit test coverage for mismatch refresh path.","notes":"Enforced source-path parity for surreal projection query loads.\n\nDelivered:\n- Updated projection load path to validate `sourceIssuesPath` against requested authority issues path.\n- On mismatch, loader now refreshes projection deterministically from canonical authority store before serving reads.\n- Preserved backward compatibility for existing projection payloads.\n- Added regression test `surreal_issue_backend_refreshes_when_projection_source_path_mismatches` that seeds a mismatched projection and verifies refreshed read results + rewritten projection metadata.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:14:02.166820Z","updated_at":"2026-02-22T11:15:23.111339Z","closed_at":"2026-02-22T11:15:23.111342Z","ephemeral":false,"dependencies":[{"issue_id":"bd-94","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-95","title":"[bd-28] Share path-equivalence normalization across backend status and projection loader","description":"Path-equivalence normalization is currently duplicated in `support.rs` and `mcp_serve.rs`.\n\nAcceptance:\n- expose one shared helper for path equivalence in CLI support layer,\n- route backend-status provenance checks and surreal projection source-path checks through the helper,\n- preserve existing behavior/tests while reducing duplicate encoding.","notes":"Reduced duplicate path normalization encoding by sharing one helper.\n\nDelivered:\n- Added shared helper `paths_equivalent(&Path, &Path)` in `crates/premath-cli/src/support.rs`.\n- Routed backend-status projection provenance check to shared helper.\n- Routed surreal projection source-path parity check in MCP loader to shared helper.\n- Removed duplicated normalization routines from `mcp_serve.rs`.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":3,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:16:04.076732Z","updated_at":"2026-02-22T11:16:43.086103Z","closed_at":"2026-02-22T11:16:43.086105Z","ephemeral":false,"dependencies":[{"issue_id":"bd-95","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-96","title":"[bd-28] Enforce projection payload/sourceSnapshotRef integrity on surreal loads","description":"Projection files now carry `sourceSnapshotRef`, but surreal query loads do not yet verify that ref against the projection payload itself.\n\nAcceptance:\n- projection loader validates `sourceSnapshotRef` (when present) equals `store_snapshot_ref` of hydrated projection issues,\n- mismatch triggers deterministic refresh from authority path before serving reads,\n- legacy projections without `sourceSnapshotRef` remain backward compatible,\n- unit test covers mismatch-refresh behavior.","notes":"Enforced projection payload/sourceSnapshotRef integrity for surreal query loads.\n\nDelivered:\n- `load_store_from_projection` now validates `sourceSnapshotRef` (when present) against `store_snapshot_ref` of hydrated projection issues.\n- Snapshot-ref mismatch is treated as projection invalidity; surreal load path refreshes from authority before serving reads.\n- Legacy projections without `sourceSnapshotRef` remain accepted (backward compatibility).\n- Added regression test `surreal_issue_backend_refreshes_when_projection_snapshot_ref_mismatches`.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:18:41.680656Z","updated_at":"2026-02-22T11:19:18.608980Z","closed_at":"2026-02-22T11:19:18.608983Z","ephemeral":false,"dependencies":[{"issue_id":"bd-96","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-97","title":"[bd-28] Enforce projection payload integrity in backend-status surface","description":"`issue backend-status` currently parses projection header only; it may report `fresh` when projection payload contradicts `sourceSnapshotRef`.\n\nAcceptance:\n- backend-status validates projection payload integrity when schema/kind parse succeeds,\n- expose deterministic boolean for `sourceSnapshotRef` vs projection payload match,\n- mark projection state invalid when payload integrity check fails,\n- add/adjust tests for malformed and mismatched projection payload cases.","notes":"Aligned backend-status projection semantics with loader integrity boundary.\n\nDelivered:\n- `collect_backend_status` now parses projection payloads (not only headers) and validates `sourceSnapshotRef` against the payload issue set snapshot.\n- Added new status field `queryProjection.snapshotRefMatchesProjection`.\n- Projection state is fail-closed to `invalid` when payload/source snapshot refs diverge.\n- Added/updated tests:\n  - `issue_backend_status_reports_integration_state` (asserts snapshotRefMatchesProjection=true)\n  - `issue_backend_status_reports_stale_projection_on_authority_change` (still true for projection integrity)\n  - `issue_backend_status_marks_invalid_when_projection_payload_snapshot_mismatches` (new regression)\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:19:55.321230Z","updated_at":"2026-02-22T11:21:16.013514Z","closed_at":"2026-02-22T11:21:16.013516Z","ephemeral":false,"dependencies":[{"issue_id":"bd-97","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
{"id":"bd-98","title":"[bd-28] Auto-refresh legacy surreal projections missing sourceSnapshotRef","description":"Legacy projection payloads without `sourceSnapshotRef` are still accepted and reported as partially unknown. Tighten determinism by auto-refreshing once into the current projection contract.\n\nAcceptance:\n- surreal projection load path refreshes when projection payload lacks `sourceSnapshotRef`,\n- refreshed payload includes deterministic `sourceSnapshotRef`,\n- backward compatibility preserved (legacy payload still results in successful reads),\n- regression test covers legacy-upgrade refresh behavior.","notes":"Implemented one-shot legacy projection upgrade for missing `sourceSnapshotRef`.\n\nDelivered:\n- Added `ProjectionLoad` metadata contract in surreal load path.\n- Projection reads now auto-refresh from authority when loaded projection payload lacks `sourceSnapshotRef`.\n- Existing source-path and snapshot-ref mismatch refresh behavior preserved.\n- Added regression test `surreal_issue_backend_refreshes_when_projection_missing_source_snapshot_ref` proving legacy payloads are upgraded while reads still succeed.\n\nValidation:\n- cargo fmt --all\n- cargo test -p premath-cli","status":"closed","priority":2,"issue_type":"task","assignee":"codex","created_at":"2026-02-22T11:21:58.408554Z","updated_at":"2026-02-22T11:22:36.030899Z","closed_at":"2026-02-22T11:22:36.030901Z","ephemeral":false,"dependencies":[{"issue_id":"bd-98","depends_on_id":"bd-28","type":"discovered-from","created_by":"codex"}]}
