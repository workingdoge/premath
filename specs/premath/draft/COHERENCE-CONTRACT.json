{
  "schema": 1,
  "contractKind": "premath.coherence.contract.v1",
  "contractId": "coherence.default.v1",
  "binding": {
    "normalizerId": "normalizer.coherence.v1",
    "policyDigest": "policy.coherence.v1"
  },
  "obligations": [
    {
      "id": "scope_noncontradiction",
      "description": "Ensure normative/informative scope and bidir checker obligation vocabulary remain non-contradictory."
    },
    {
      "id": "capability_parity",
      "description": "Ensure capability IDs match across executable surfaces, manifests, and indexed docs."
    },
    {
      "id": "gate_chain_parity",
      "description": "Ensure baseline and projected gate-chain documentation matches executable command surfaces."
    },
    {
      "id": "operation_reachability",
      "description": "Ensure required operation surfaces exist and are reachable from doctrine root."
    },
    {
      "id": "overlay_traceability",
      "description": "Ensure declared profile overlays are present and indexed coherently."
    },
    {
      "id": "transport_functoriality",
      "description": "Ensure base/fibre transport fixtures satisfy identity, composition, and naturality equalities under deterministic canonicalization."
    },
    {
      "id": "span_square_commutation",
      "description": "Ensure pipeline/base-change span-square witnesses are typed, digest-stable, and commute under accepted squares."
    },
    {
      "id": "coverage_base_change",
      "description": "Ensure admissible covers remain stable under base-change pullbacks over context refinements."
    },
    {
      "id": "coverage_transitivity",
      "description": "Ensure composed covers equal the deterministic union of refinement covers over an outer cover."
    },
    {
      "id": "glue_or_witness_contractibility",
      "description": "Ensure descent outcomes are deterministic glue-or-obstruction witnesses (never neither, never both)."
    },
    {
      "id": "cwf_substitution_identity",
      "description": "Ensure strict CwF substitution identity equalities hold for types and terms."
    },
    {
      "id": "cwf_substitution_composition",
      "description": "Ensure strict CwF substitution composition equalities hold for types and terms."
    },
    {
      "id": "cwf_comprehension_beta",
      "description": "Ensure strict CwF comprehension beta equalities hold for generic term substitution."
    },
    {
      "id": "cwf_comprehension_eta",
      "description": "Ensure strict CwF comprehension eta equalities hold for substitution reconstruction."
    }
  ],
  "conditionalCapabilityDocs": [
    {
      "docRef": "draft/LLM-INSTRUCTION-DOCTRINE",
      "capabilityId": "capabilities.instruction_typing"
    },
    {
      "docRef": "draft/LLM-PROPOSAL-CHECKING",
      "capabilityId": "capabilities.instruction_typing"
    },
    {
      "docRef": "raw/SQUEAK-SITE",
      "capabilityId": "capabilities.squeak_site"
    },
    {
      "docRef": "raw/PREMATH-CI",
      "capabilityId": "capabilities.ci_witnesses"
    }
  ],
  "expectedOperationPaths": [
    "tools/ci/run_gate.sh",
    "tools/ci/run_instruction.sh",
    "tools/ci/verify_required_witness.py",
    "tools/ci/decide_required.py",
    "tools/conformance/check_stub_invariance.py",
    "tools/conformance/run_capability_vectors.py",
    "tools/conformance/check_doctrine_site.py",
    "tools/conformance/run_doctrine_inf_vectors.py"
  ],
  "overlayDocs": [
    "profile/ADJOINTS-AND-SITES"
  ],
  "requiredBidirObligations": [
    "stability",
    "locality",
    "descent_exists",
    "descent_contractible",
    "adjoint_triple",
    "ext_gap",
    "ext_ambiguous"
  ],
  "surfaces": {
    "capabilityRegistryPath": "specs/premath/draft/CAPABILITY-REGISTRY.json",
    "capabilityRegistryKind": "premath.capability_registry.v1",
    "capabilityManifestRoot": "tests/conformance/fixtures/capabilities",
    "readmePath": "README.md",
    "conformanceReadmePath": "tools/conformance/README.md",
    "conformancePath": "specs/premath/draft/CONFORMANCE.md",
    "specIndexPath": "specs/premath/draft/SPEC-INDEX.md",
    "specIndexCapabilityHeading": "5.4",
    "specIndexInformativeHeading": "5.5",
    "specIndexOverlayHeading": "5.6",
    "ciClosurePath": "docs/design/CI-CLOSURE.md",
    "ciClosureBaselineStart": "Current full baseline gate (`mise run baseline`) includes:",
    "ciClosureBaselineEnd": "Local command:",
    "ciClosureProjectionStart": "Current deterministic projected check IDs include:",
    "ciClosureProjectionEnd": "## 5. Variants and capability projection",
    "misePath": ".mise.toml",
    "miseBaselineTask": "baseline",
    "controlPlaneContractPath": "specs/premath/draft/CONTROL-PLANE-CONTRACT.json",
    "doctrineSitePath": "specs/premath/draft/DOCTRINE-SITE.json",
    "doctrineSiteInputPath": "specs/premath/draft/DOCTRINE-SITE-INPUT.json",
    "doctrineOperationRegistryPath": "specs/premath/draft/DOCTRINE-OP-REGISTRY.json",
    "doctrineRootNodeId": "draft/DOCTRINE-INF",
    "profileReadmePath": "specs/premath/profile/README.md",
    "bidirSpecPath": "specs/premath/draft/BIDIR-DESCENT.md",
    "bidirSpecSectionStart": "## 6. Obligation kinds (normative)",
    "bidirSpecSectionEnd": "### 6.1 Obligation record format (required)",
    "coherenceSpecPath": "specs/premath/draft/PREMATH-COHERENCE.md",
    "coherenceSpecObligationStart": "## 3. Obligation Set (normative)",
    "coherenceSpecObligationEnd": "## 4. Obligation Semantics",
    "obligationRegistryKind": "premath.obligation_gate_registry.v1",
    "informativeClauseNeedle": "unless they are\nexplicitly claimed under ยง5.4 or ยง5.6",
    "transportFixtureRootPath": "tests/conformance/fixtures/coherence-transport",
    "siteFixtureRootPath": "tests/conformance/fixtures/coherence-site"
  }
}
